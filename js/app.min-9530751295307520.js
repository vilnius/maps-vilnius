var MAPCONFIG={themes:{newTheme:{url:"https://maps.vilnius.lt",production:!0,custom:!0,name:"Nauja žemėlapio versija",id:"nauja-versija",imgUrl:"/maps_vilnius/img/home-url.png",imgAlt:"Nauja žemėlapio versija",layers:{administravimas:{dynimacLayerUrls:"https://gis.vplanas.lt/arcgis/rest/services/Interaktyvus_zemelapis/Mokyklos/MapServer"}}},buildingsAdministration:{production:!0,custom:!0,name:"Pastatų administravimas",id:"theme-buildings",imgUrl:"/maps_vilnius/img/pastatu-administravimas.png",imgAlt:"Pastatų administravimas",layers:{administravimas:{dynimacLayerUrls:"https://zemelapiai.vplanas.lt/arcgis/rest/services/Interaktyvus_zemelapis/Pastatu_administravimas/MapServer",featureLayerUrls:["https://zemelapiai.vplanas.lt/arcgis/rest/services/Interaktyvus_zemelapis/Pastatu_administravimas/MapServer/1"]}}},advertise:{production:!0,custom:!0,name:"Reklamos leidimai",id:"ad",imgUrl:"/maps_vilnius/img/reklamos.png",imgAlt:"Reklamos vietos"},schools:{production:!0,custom:!0,name:"Švietimas",id:"schools",imgUrl:"/maps_vilnius/img/mokyklos.png",imgAlt:"Švietimas",layers:{mokyklos:{dynimacLayerUrls:"https://gis.vplanas.lt/arcgis/rest/services/Interaktyvus_zemelapis/Mokyklos/MapServer"}}}},mapExtent:{xmin:555444.210800001,ymin:6051736.22,xmax:606967.016199999,ymax:6076388.28,spatialReference:{wkid:3346}},staticServices:{basemapUrl:"https://zemelapiai.vplanas.lt/arcgis/rest/services/Baziniai_zemelapiai/Vilnius_basemap_1000/MapServer",ortofotoUrl:"https://zemelapiai.vplanas.lt/arcgis/rest/services/Baziniai_zemelapiai/ORT5LT_2016/MapServer",geometryUrl:"https://zemelapiai.vplanas.lt/arcgis/rest/services/Utilities/Geometry/GeometryServer"},themesServices:{buildingTheme:{featureLayerBuildings:"https://zemelapiai.vplanas.lt/arcgis/rest/services/Interaktyvus_zemelapis/Pastatu_administravimas/MapServer/1",dynamicLayerBuildings:"https://zemelapiai.vplanas.lt/arcgis/rest/services/Interaktyvus_zemelapis/Pastatu_administravimas/MapServer"},dynamicLayerAdverts:"https://zemelapiai.vplanas.lt/arcgis/rest/services/Interaktyvus_zemelapis/Reklamos_registro_leidimai/MapServer",featureLayerAdverts:"https://zemelapiai.vplanas.lt/arcgis/rest/services/Interaktyvus_zemelapis/Reklamos_registro_leidimai/MapServer/0"}};Array.prototype.getUnique=function(){"use strict";var a={},b=[],c=0,d=this.length;for(d;c<d;c+=1)a.hasOwnProperty(this[c])||(b.push(this[c]),a[this[c]]=1);return b},window.location.hash="#",require(["dojo/i18n!esri/nls/jsapi","esri/map","esri/dijit/HorizontalSlider","dojo/_base/connect","esri/toolbars/navigation","esri/config","dojo/on","dojo/query","esri/layers/ArcGISTiledMapServiceLayer","esri/layers/ArcGISDynamicMapServiceLayer","esri/dijit/Legend","dojo/_base/array","dojo/parser","esri/dijit/Popup","esri/dijit/PopupTemplate","esri/InfoTemplate","esri/layers/FeatureLayer","dojo/_base/declare","dojo/promise/all","dojo/Deferred","dgrid/OnDemandGrid","dgrid/Selection","dojo/store/Memory","dijit/form/CheckBox","dijit/registry","esri/tasks/query","esri/tasks/QueryTask","esri/request","dojo/dom","dojo/dom-construct","dojo/dom-class","esri/renderers/ClassBreaksRenderer","esri/symbols/PictureMarkerSymbol","esri/dijit/Measurement","esri/units","esri/dijit/Search","esri/tasks/locator","esri/symbols/SimpleFillSymbol","esri/symbols/SimpleMarkerSymbol","esri/renderers/SimpleRenderer","esri/symbols/SimpleLineSymbol","esri/Color","esri/geometry/Extent","esri/tasks/GeometryService","app/clusterfeaturelayer","esri/graphic","esri/graphicsUtils","dojo/dom-style","dojo/_base/fx","dojo/fx/easing","esri/dijit/Scalebar","esri/layers/LayerInfo","esri/tasks/IdentifyTask","esri/tasks/IdentifyParameters","dijit/layout/ContentPane","dijit/layout/TabContainer","dijit/layout/BorderContainer","dojo/domReady!"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M,N,O,P,Q,R,S,T,U,V,W,X,Y,Z,$,_,aa){function ba(){var a=document.getElementById("map").offsetHeight/2,b=document.getElementById("map").offsetWidth/2,c=new esri.geometry.ScreenPoint(b,a,qa.spatialReference),d=qa.toMap(c);setTimeout(function(){qa.centerAt(d)},50)}function ca(){return qa.extent.getWidth()/qa.width}function da(){var a=h(".dijitCheckBoxInput"),b=[];l.forEach(a,function(c){c.checked&&(b.push(c.id),b.push(0)),a[0].checked?(Ba.show(),Ea.show(),Ca.show(),"ad"===ma.currentTheme()&&Na.show()):(Ba.hide(),Ea.hide(),Ca.hide(),"ad"===ma.currentTheme()&&Na.hide())}),0===b.length&&b.push(-1),Da.setVisibleLayers(b);var c=ma.currentTheme();"ad"===c?c={layer:Ea}:"theme-buildings"===c&&(c={layer:Da}),legendDijit.refresh([c])}function ea(a){window.location.hash===a.currentTarget.getAttribute("href")&&(window.location.hash="#closed",a.preventDefault(),Ia.deactivate())}var fa,ga,ha,ia,ja=[],ka={},la={extent:new esri.geometry.Extent(MAPCONFIG.mapExtent),popupProperties:{titleInBody:!1},popupDom:D.create("div",{id:"default-popup"}),popup:function(){var a=this;return new n(a.popupProperties,a.popupDom)}},ma={_getUrlQueryName:function(a,b){b||(b=window.location.href),b=b.toLowerCase(),a=a.replace(/[\[\]]/g,"\\$&").toLowerCase();var c=new RegExp("[?&]"+a+"(=([^&#]*)|&|#|$)"),d=c.exec(b);return d?d[2]?decodeURIComponent(d[2].replace(/\+/g," ")):"":null},mapInit:function(){return new b("map",{extent:la.extent,logo:!1,showAttribution:!1,zoom:5,infoWindow:la.popup(),nav:!1})},currentTheme:function(){return this._getUrlQueryName("theme")},currenthemeLabel:function(){for(var a=this.currentTheme(),b=document.getElementById("theme"),c=b.getElementsByTagName("div"),d=0;d<c.length;d++)c[d].id===a?c[d].className+=" current-theme":(c[d].className=c[d].className.replace(/(?:^|\s)current-theme(?!\S)/g,""),a||(document.getElementById("theme-buildings").className+=" current-theme"))},showCursor:function(a,b){b.forEach(a,function(a,b){a.on("mouse-over",function(){qa.setMapCursor("pointer")}),a.on("mouse-out",function(){qa.setMapCursor("default")})})},createThemeDom:function(){var a=MAPCONFIG.themes,b=1;for(var c in a)if(a.hasOwnProperty(c)){var d,e,f,g,h,i;if(d=e=f=g=h=i=null,a.hasOwnProperty(c)&&a[c].production&&!a[c].hide){b++;var j;j=h=b%2>0?"align-right":"align-left",d=D.create("div",{id:a[c].id,"class":"sub-theme "+h,style:""},"theme","last"),i=a[c].url?a[c].url:"./?theme="+a[c].id,e=D.create("a",{href:i},d),g=D.create("img",{src:a[c].imgUrl,alt:a[c].imgAlt},e),f=D.create("p",{innerHTML:a[c].name},d)}}},initTheme:function(){var a,b=MAPCONFIG.themes,c=this.currentTheme();for(var d in b)if(b.hasOwnProperty(d)){var e=b[d].id,f=b[d].custom;if(e===c&&!f){var g=[];a=this.createDynicLayers(b[d],d);for(var h in a)a.hasOwnProperty(h)&&g.push(a[h]);g=g.reverse(),this.addDynamicLayers(g),this.runShowLegendInput(a)}}return a},runShowLegendInput:function(a){var b=this;setTimeout(function(){b.showLegendInput(a)},1e3)},addDynamicLayers:function(a){for(var b=0;b<a.length;b++)qa.addLayer(a[b])},reorderLayers:function(){l.forEach(qa.layerIds,function(a,b){b>1&&qa.reorderLayer("dyn-demo-bp",2)})},createDynicLayers:function(a,b){var c={},d=a.layers;for(var e in d)if("undefined"!=typeof e){var f="dyn-"+b+"-"+e,g=d[e].name;this.createLegendGroups(f,g,a.name),c["dyn"+b+e]=new j(d[e].dynimacLayerUrls,{id:"dyn-"+b+"-"+e}),c["dyn"+b+e].configLayerName=e,d[e].name?c["dyn"+b+e].groupName=d[e].name:c["dyn"+b+e].groupName=a.name}return c},createLegendGroups:function(a,b,c){var d,e=document.createElement("div"),f=C.byId("legend-list");C.byId(a)||(d=b?D.toDom("<div class='layer-group'><p>"+b+"</p></div><div id='"+a+"'></div>"):D.toDom("<div class='layer-group'><p>"+c+"</p></div><div id='"+a+"'></div>")),e.setAttribute("class","legend-group"),e.appendChild(d),D.place(e,f,"last")},setOpacity:function(a){for(var b in a)a.hasOwnProperty(b)&&a[b].setOpacity(value/100)},createLayerInfosArr:function(a){var b=[];for(var c in a)a.hasOwnProperty(c)&&(a[c].layerInfos.nameGroup=c,a[c].layerInfos.layersGroupName=a[c].groupName,b.push(a[c].layerInfos));return this.createLayerInfosWithGroupName(b)},createLayerInfosWithGroupName:function(a){for(var b=0;b<a.length;b++)a[b]=this.createGroupName(a[b],a[b].nameGroup,a[b].layersGroupName);return this.createLayerInfosResultArr(a)},createLayerInfosResultArr:function(a){var b;return b=[].concat.apply([],a)},createGroupName:function(a,b,c){for(var d=0;d<a.length;d++)a[d].groupName=b,a[d].layersGroupName=c;return a},createLayersGroupsDom:function(a){var b=C.byId("layer-list"),c=l.map(a,function(a,b){return a.groupName}),d=c.filter(function(a,b,c){return c.indexOf(a)===b});l.forEach(d,function(a,c){var d=document.createElement("div");d.setAttribute("id",a),d.setAttribute("class","default-theme-layers"),b.appendChild(d)}),this.addtitleToGroups(a)},addtitleToGroups:function(a){l.map(a,function(a){document.getElementById(a.groupName).innerHTML="<div class='layer-group'><p>"+a.layersGroupName+"</p></div>"})},showLegendInput:function(a){var b=C.byId("layer-list"),c=this;setTimeout(function(){var d=c.createLayerInfosArr(a);c.createLayersGroupsDom(d);l.forEach(d,function(a,b){var c=new x({"class":"layers-labels",tabindex:a.id.toString(),value:a.groupName,checked:!!a.defaultVisibility,id:b.toString()});a.defaultVisibility&&ja.push(a.id);var d,e=document.getElementById(a.groupName),f=document.createElement("div");if(null===a.subLayerIds){var g=c.domNode;d=D.toDom("<label for='"+b+"'>"+a.name+"</label>"),g.appendChild(d),f.appendChild(g),e&&e.appendChild(f)}else d=D.toDom("<div class='layer-group one-service"+(0===b?" first-one-service":"")+"'><p>"+a.name+"</p></div>"),f.appendChild(d),e&&(e.appendChild(f),E.add(document.body,"one-service-theme"))});for(var e in a)a.hasOwnProperty(e)&&(a[e]._defaultVisibleLayers?a[e].setVisibleLayers(a[e]._defaultVisibleLayers):a[e].setVisibleLayers([]));var f=c.setupDefaultLegendLayers(a);c.initLegend(f,b,a),c.initIdentify(f)},400)},createLegendGroup:function(a){setTimeout(function(){l.forEach(a,function(a,b){var c=document.createElement("div"),d="legend-list_"+a.layer.id,e=C.byId(d),f=D.toDom("<p>"+a.layer.groupName+"</p>");c.setAttribute("class","layer-group"),c.appendChild(f),D.place(c,e,"first")})},400)},initLegend:function(a,b,c){var d=this;a.reverse();return l.forEach(a,function(e,f){d.startUpLegendGroup(e,b,c,a)}),a},startUpLegendGroup:function(a,b,c,d){var e=this,f=new k({map:qa,layerInfos:[a]},a.layer.id);f.startup(),g(b,"click",function(b){e.updateLayerVisibility(c,b,f,[a],d)})},showGroups:function(a){this.createLegendGroup(a)},setupDefaultLegendLayers:function(a){var b=[];for(var c in a)a.hasOwnProperty(c)&&b.push({layer:a[c],title:" "});return b},updateLayerVisibility:function(a,b,c,d,e){var f=h(".layers-labels input"),g=[],i={};l.forEach(f,function(a){a.checked&&(ja.push(a.id),g.push(a.value),i.hasOwnProperty(a.value)?i[a.value].push(a.tabIndex):(i[a.value]=[a.tabIndex],ka[a.value]=["-1"]))});for(var j in i)i.hasOwnProperty(j)&&0===i[j].length&&i[j].push(-1);b&&this.showHideLayers(a,this.cloneVisibleLayer(i,ka,b),b),c.refresh(d),this.updatedIdentify(e)},cloneVisibleLayer:function(a,b,c){for(var d in b)if(b.hasOwnProperty(d))for(var e in a)a.hasOwnProperty(e)&&d===e?d==c.target.value&&(b[e]=a[e]):d===c.target.value&&(b[e]=["-1"]);return b},showHideLayers:function(a,b,c){for(var d in a)a.hasOwnProperty(d)&&a[d].layerInfos.nameGroup===c.target.value&&this.getCurrentInput(c,a[d],b)},getCurrentInput:function(a,b,c){c.hasOwnProperty(a.target.value)&&b.setVisibleLayers(c[a.target.value])},initIdentify:function(a){fa=this.getParameters(a),qa.on("click",this.executeIdentify)},updatedIdentify:function(a){fa=this.getParameters(a)},getParameters:function(a){var b,c={};for(var d in a)"getUnique"!==d&&(ga=new $(a[d].layer.url),b=new _,b.tolerance=3,b.returnGeometry=!0,b.layerIds=this.getVisibleLayerIds(a[d].layer.visibleLayers),b.layerOption=_.LAYER_OPTION_VISIBLE,b.width=qa.width,b.height=qa.height,c[a[d].layer.configLayerName]=b,c[a[d].layer.configLayerName].identifyTask=ga);return c},getVisibleLayerIds:function(a){var b=[];return l.map(a,function(a,c){b.push(a)}),b},executeIdentify:function(a){if(!Ia.activeTool){var b=/(\d+)[.](\d+)[.](\d+)\s.*/,c=function(a){return null!==a.match(b)},d=[],e=function(){return fa[f].identifyTask.execute(fa[f]).addCallback(function(a){return l.map(a,function(d){defResponse=a;var e=d.feature,f=" ",g=d.layerName,h=e.attributes;e.attributes.layerName=g;for(var i in h)if(h.hasOwnProperty(i))if("OBJECTID"!=i&&"layerName"!=i&&"SHAPE"!=i&&"SHAPE.area"!=i&&"Shape.area"!=i&&"SHAPE.STArea()"!=i&&"Shape"!=i&&"SHAPE.len"!=i&&"Shape.len"!=i&&"SHAPE.STLength()"!=i&&"SHAPE.fid"!=i&&"Class value"!=i&&"Pixel Value"!=i&&"Count_"!=i)if(c(h[i])){h[i];f+="<p class='bord'>"+h[i].replace(b,"$1-$2-$3")+"</br><span>"+i+"</span><p>"}else{var j=h[i];null!==j?" "!==j&&"Null"!==j||(j="-"):j="-",f+="<p class='bord'>"+j+"</br><span>"+i+"</span><p>"}else"Class value"!=i&&"Pixel Value"!=i||(f='<p class="raster">Išsamesnė sluoksnio informacija pateikiama Meniu lauke <strong>"Žymėjimas"</strong></p>');var k=new p("<p>${layerName}</p>",f);return e.setInfoTemplate(k),E.add("default-popup","default-popup"),e})})};for(var f in fa){var g,h=qa.extent.getWidth()/qa.width,i=8*h;if(fa.hasOwnProperty(f)){fa[f].geometry=a.mapPoint,fa[f].mapExtent=qa.extent,g=new Q({xmin:fa[f].geometry.x-i,ymin:fa[f].geometry.y-i,xmax:fa[f].geometry.x+i,ymax:fa[f].geometry.y+i,spatialReference:fa[f].geometry.spatialReference}),fa[f].geometry=g;var j=e();d.push(j)}}s(d.reverse()).then(function(b){var c=[].concat.apply([],b);c.length>0&&(qa.infoWindow.setFeatures([].concat.apply([],d)),qa.infoWindow.show(a.mapPoint))})}},setDefaultSelectionSymbol:function(a){var b=new L(L.STYLE_SOLID,new O(O.STYLE_SOLID,new P([193,39,45,1]),3),new P([129,183,206,0]));a.setSymbol(b),qa.graphics.add(a)}};ma.createThemeDom(),m.parse(),ma.currenthemeLabel(),a.widgets.legend.NLS_noLegend="Grupės sluoksniai išjungti arba per didelis mastelis",a.widgets.popup.NLS_zoomTo="Priartinti",a.widgets.popup.NLS_pagingInfo="<span class='index-total'>(${index} iš ${total})</span>";var na=(C.byId("loading-gif"),new esri.geometry.Extent(MAPCONFIG.mapExtent)),oa={fillSymbol:new L(L.STYLE_SOLID,new O(O.STYLE_SOLID,new P([193,39,45,1]),3),new P([129,183,206,0])),markerSymbol:new M("circle",24,new O(O.STYLE_LONGDASH,new P([223,52,59,0]),3),new P([255,255,255,0])),lineSymbol:new O(O.STYLE_DASH,new P([193,39,45,1]),3),titleInBody:!1},pa=D.create("div",{id:"default-popup"});ia=new n(oa,pa);var qa=new b("map",{extent:na,logo:!1,showAttribution:!1,zoom:1,infoWindow:ia,nav:!1}),ra=(new e(qa),dojo.byId("zoomfullext"));g(ra,"click",function(){var a=na.getCenter();qa.centerAndZoom(a,0)}),qa.on("resize",function(){ba()});new Y({map:qa,scalebarUnit:"metric"});f.defaults.io.proxyUrl="proxy/proxy.php",f.defaults.io.corsEnabledServers.push("https://zemelapiai.vplanas.lt");var sa=MAPCONFIG.staticServices.basemapUrl,ta=MAPCONFIG.staticServices.ortofotoUrl,ua=MAPCONFIG.themesServices.buildingTheme.featureLayerBuildings,va=MAPCONFIG.themesServices.featureLayerAdverts,wa=MAPCONFIG.themesServices.buildingTheme.dynamicLayerBuildings,xa=MAPCONFIG.themesServices.dynamicLayerAdverts,ya=MAPCONFIG.staticServices.geometryUrl,za=(new p,new i(sa,{id:"topo"})),Aa=new i(ta,{id:"orto"}),Ba=new q(ua,{id:"buildings-feat",mode:q.MODE_ONDEMAND,maxAllowableOffset:ca(),outFields:["*"]}),Ca=new q(va,{id:"adverts-feat",mode:q.MODE_ONDEMAND,outFields:["*"]}),Da=new j(wa,{opacity:1,id:"buildings-dyn"}),Ea=new j(xa,{id:"adverts"});Ea.suspend();var Fa=[za,Aa];qa.addLayers(Fa);var Ga=ma.initTheme();esri.config.defaults.geometryService=new R(ya);var Ha=esri.config.defaults.geometryService,Ia=new H({map:qa,defaultAreaUnit:I.HECTARES,defaultLengthUnit:I.KILOMETERS,deactivate:function(){var a=this.getTool();a&&(this.setTool(a.toolName,!1),this.clearResult())}},C.byId("tools-measure"));Ia.startup();var Ja=document.getElementById("top-menu").getElementsByTagName("a");l.forEach(Ja,function(a){g(a,"click",function(){Ia.deactivate()})}),za.show(),Aa.hide(),Aa.hide();var Ka=document.getElementById("ortofoto");g(Ka,"click",function(){"none"===dojo.byId("zem").style.display?(dojo.byId("ort").style.display="none",dojo.byId("zem").style.display="block",Aa.show(),za.hide()):(dojo.byId("ort").style.display="block",dojo.byId("zem").style.display="none",za.show(),Aa.hide())});var La=new J({sources:[{locator:new K("https://zemelapiai.vplanas.lt/arcgis/rest/services/Lokatoriai/PAIESKA_COMPOSITE/GeocodeServer"),singleLineFieldName:"SingleLine",outFields:["*"],enableSuggestions:!0,name:"Paieška",enableHighlight:!0,enableLabel:!1,localSearchOptions:{minScale:3e5,distance:5e4},placeholder:"Paieška",highlightSymbol:new G("/maps_vilnius/img/map_marker.png",36,36).setOffset(0,12)}],map:qa},"search");if(La.startup(),g(La,"select-result",function(){setTimeout(function(){ia.hide()},4e3)}),ha=new c({labels:["0 %","100 %"],value:90,minimum:0,maximum:100,intermediateChanges:!0,discreteValues:100,showButtons:!1,onChange:function(a){if("ad"===ma.currentTheme())Na.setOpacity(a/100);else if("theme-buildings"===ma.currentTheme()||null===ma.currentTheme()||""===ma.currentTheme())Ba.setOpacity(a/100),Da.setOpacity(a/100);else for(var b in Ga)Ga.hasOwnProperty(b)&&Ga[b].setOpacity(a/100)}},"tools-opacity-widget"),ha.startup(),Ga)for(var Ma in Ga)Ga.hasOwnProperty(Ma)&&(Ga[Ma].setOpacity(ha.value/100),"accidentsRaster"===Ga[Ma].configLayerName&&Ga[Ma].setOpacity(.6));switch("ad"===ma.currentTheme()||"theme-buildings"!==ma.currentTheme()&&null!==ma.currentTheme()&&""!==ma.currentTheme()||Da.setOpacity(ha.value/100),ma.currentTheme("theme")){case"ad":var Na=permitsTheme(qa);qa.on("layer-add-result",function(a){});break;case"theme-buildings":E.add(document.body,"building-theme"),buildingsTheme(qa,Ba,Ia,ua,ma.showCursor);break;case null:E.add(document.body,"building-theme"),buildingsTheme(qa,Ba,Ia,ua,ma.showCursor);break;case"schools":y.byId("mainWindow"),new aa({region:"right",style:"width: 346px; padding: 0","class":"schools",content:"<p class='build-p'>Mokyklų paieška pagal adresą:</p><div id='schools-filter'><p>Mokyklų filtravimas<a href='/maps_vilnius/schools.htm' target='_blank' class='red' style='display: none;'>( išimtys )</a>: <br><label>pagal kalbą</label><label class='class-year'>pagal klasę</label><span id='language-filter'></span><span id='year-filter'></span></p></div><div id='search-schools'></div><div id='schools-list' class='module-schools animate'><div id='schools-data'></div><div class='bg-w'><p><span>Priskirtas mokyklų sąrašas:</span></p><ul id='schools-filtered-list'></ul></div></div><div id='schools-info'></div>"}).placeAt("mainWindow").startup();E.add(document.body,"schools-theme"),schoolsTheme(qa,MAPCONFIG,Ia,ma.showCursor,ha,ia,Ha);break;default:E.add(document.body,"default-theme")}qa.on("update-start",function(){E.add("loading-gif","show"),E.remove("loading-gif","hide")}),qa.on("update-end",function(){E.remove("loading-gif","show"),E.add("loading-gif","hide")}),"ad"===ma.currentTheme()?qa.addLayers([Ea]):"theme-buildings"!==ma.currentTheme()&&null!==ma.currentTheme()&&""!==ma.currentTheme()||qa.addLayers([Da]),g(qa,"onZoomEnd",function(){maxOffset=ca(),Ma.setMaxAllowableOffset(maxOffset)}),qa.infoWindow.resize(350,300),qa.on("layers-add-result",function(a){if("ad"===ma.currentTheme()||"theme-buildings"===ma.currentTheme()||null===ma.currentTheme()||""===ma.currentTheme()){var b=function(b,c){var d=l.map(b.layerInfos,function(a,b){var d;return b!==c?void(a.defaultVisibility&&ja.push(a.id)):(d=new x({"class":"layers-labels",checked:a.defaultVisibility?"checked=checked":"",id:a.id.toString()}),a.defaultVisibility&&ja.push(a.id),inputsList=d.domNode,label=D.toDom("<label for='"+a.id+"'>"+a.name+"</label>"),inputsList.appendChild(label),tmp=document.createElement("div"),tmp.appendChild(inputsList),tmp.innerHTML)}),e=C.byId("layer-list");e.innerHTML=d.join(" "),Da.setVisibleLayers(ja),g(e,"click",da);var f=l.map(a.layers,function(a,b){return{layer:a.layer,title:"Įjungti sluoksniai"}});f.length<2&&(legendDijit=new k({map:qa,layerInfos:f},"legend-list"),legendDijit.startup())};"ad"===ma.currentTheme()?b(Ea,0):"theme-buildings"!==ma.currentTheme()&&null!==ma.currentTheme()&&""!==ma.currentTheme()||b(Da,1)}});for(var Oa=document.getElementsByTagName("a"),Pa=0;Pa<Oa.length;Pa++)Oa[Pa].addEventListener("click",ea,!1);var Qa=new Date,Ra=Qa.getFullYear();document.getElementById("credits").innerHTML=Ra+" m. | VMS interaktyvūs žemėlapiai | <a href='#' id='copyright'>Autorinės teisės</a> | <a href='http://www.vilniausplanas.lt/' target='_blank'>SĮ „Vilniaus planas“</a>";var Sa=[Ba,Ca];ma.showCursor(Sa,l),require(["dijit/Tooltip"],function(a){new a({connectId:"copyright",id:"cop-class",position:["above"],label:"© SĮ Vilniaus planas <br>© Vilniaus miesto savivaldybė<br>ORT5LT © Nacionalinė žemės tarnyba prie ŽŪM<br>© Valstybinė saugomų teritorijų tarnyba prie Aplinkos ministerijos<br>© Policijos departamentas prie Vidaus reikalų ministerijos"})})});var permitsTheme=function(a){var b;return require(["dojo/on","esri/dijit/Popup","esri/dijit/PopupTemplate","esri/InfoTemplate","dojo/promise/all","dojo/Deferred","esri/tasks/query","esri/tasks/QueryTask","esri/request","dojo/dom","dojo/dom-construct","dojo/dom-class","esri/renderers/ClassBreaksRenderer","esri/symbols/SimpleFillSymbol","esri/symbols/SimpleMarkerSymbol","esri/renderers/SimpleRenderer","esri/symbols/SimpleLineSymbol","esri/Color","esri/geometry/Extent","app/clusterfeaturelayer","esri/graphic","esri/graphicsUtils","dojo/dom-style","dojo/_base/fx","dojo/fx/easing","esri/layers/LayerInfo"],function(c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B){function C(a){var b,c="",d=a.length;if(d>1)for(var e=0;e<d;e++)b="<p></i><a href='"+a[e].url+"' target='blank'>"+a[e].icon+"</a></p>",c+=b;else"Dokumentų nėra"===a[0]&&(b="<p><i class='fa fa-exclamation'></i><span>"+a[0]+"</span></p>",c+=b);return l.byId("default-attachment").innerHTML=c,a}function D(){clearTimeout(X),X=setTimeout(function(){var b,c=a.infoWindow.selectedIndex;if(c!==-1){b=a.infoWindow.features[c],I(),a.infoWindow._lastSelected=new w(b.toJson()),a.infoWindow._lastSelected.setSymbol(P),a.graphics.add(a.infoWindow._lastSelected);var d=H(b);d.then(function(a){})}},50)}function E(a){var b=new h,c=new i;c.returnGeometry=!1,c.outFields=["ID","VLN_REKLAMOS_ID","CONTENTTYPE","TITLE "],c.where="VLN_REKLAMOS_ID = '"+a+"'";var d;return d=new j("https://zemelapiai.vplanas.lt/arcgis/rest/services/Interaktyvus_zemelapis/Reklamos_registro_leidimai/MapServer/1"),b.resolve({query:c,task:d}),b.promise}function F(a){Y=setTimeout(function(){Q.length=0,window.clearTimeout(Y);var b="http://www.vilnius.lt/isorei/isorinereklama/files/",c=a.features;if(0!==c.length)for(var d=function(){runURL=function(a){C.call(null,Q)},setTimeout(function(){runURL(Q)},500)},e=0;e<c.length;e++){var f=a.features[e].attributes.CONTENTTYPE,g=parseInt(a.features[e].attributes.VLN_REKLAMOS_ID,10),h=a.features[e].attributes.TITLE,i=b+g+"_"+h,j={url:i,icon:G(f)};Q.push(j),d()}else Q=["Dokumentų nėra"],runURL=function(a){C.call(null,Q)},setTimeout(function(){runURL(Q)},50);return Q},1e3)}function G(a){var b="",c=a.split("/"),d=c.length,e=c[d-1];switch(e){case"pdf":b="<i class='fa fa-file-pdf-o' aria-hidden='true'></i>";break;case"vnd.openxmlformats-officedocument.wordprocessingml.document":b="<i class='fa fa-file-word-o' aria-hidden='true'></i>";break;case"vnd.lt.archyvai.adoc-2008":b="<i class='fa fa-file-word-o' aria-hidden='true'></i>";break;case"vnd.ms-excel":b="<i class='fa fa-file-excel-o' aria-hidden='true'></i>";break;case"jpeg":b="<i class='fa fa-file-image-o' aria-hidden='true'></i>";break;default:b="<i class='fa fa-file-o' aria-hidden='true'></i>"}return b}function H(b){var c,d=new h;n.contains("default-popup","invalid-ad")?n.remove("default-popup","invalid-ad"):n.contains("default-popup","valid-ad")&&n.remove("default-popup","valid-ad");var e=b.attributes.GALIOJA,f=b.attributes.ID;if(f&&e){var g=E(f);g.then(function(a){setTimeout(function(){a.task.execute(a.query,F),d.resolve(a)},100)}),1===e||3===e?(a.infoWindow.setTitle("Galiojantis reklamos registro leidimas "),N.setTitle("Galiojantis reklamos registro leidimas "),c=n.contains("default-popup","invalid-ad")?n.remove("default-popup","invalid-ad"):n.add("default-popup","valid-ad"),n.add("default-popup","valid-ad")):2===e&&(a.infoWindow.setTitle("Negaliojantis reklamos registro leidimas "),N.setTitle("Negaliojantis reklamos registro leidimas "),c=n.contains("default-popup","valid-ad")?n.remove("default-popup","valid-ad"):n.add("default-popup","invalid-ad"),n.add("default-popup","invalid-ad"))}return d.promise}function I(){a.infoWindow._lastSelected&&(a.graphics.remove(a.infoWindow._lastSelected),a.infoWindow._lastSelected=null)}function J(a,b,c){var d;a&&(a.setAttribute("fill-opacity",b),a.setAttribute("stroke-opacity",c),d=a.nextElementSibling,d&&"text"===d.nodeName&&d.setAttribute("fill-opacity",1))}function K(){y.set(a.infoWindow.domNode,"opacity",0),z.fadeIn({node:a.infoWindow.domNode,duration:150,easing:A.quadIn}).play()}var L=l.byId("loading-gif");a.on("update-start",function(){esri.show(L)}),a.on("update-end",function(){esri.hide(L)}),a.on("click",function(a){});var M,N,O,P,Q=[];popup=a.infoWindow,popup.highlight=!1,popup.titleInBody=!1,N=new f,N.setContent("<ul><li>${DATA:DateFormat(selector: 'date', fullYear: true)}<br><span>Leidimo data</span></li><li>${GALIOJA_IKI:DateFormat(selector: 'date', fullYear: true)}<br><span>Galioja iki</span></li><li>${ADRESAS}<br><span>Adresas</span></li><li>${SENIUNIJA}<br><span>Seniūnija</span></li><li>${UZSAKOVAS}<br><span>Užsakovas</span></li><li>${UZSAKOVO_KODAS}<br><span>Užsakovo kodas</span></li></ul><p>Dokumentai atsisiųsti:</p><div id='default-attachment'><p style='text-align: center;'><img src='./img/ajax-loader.gif' style=' width: 20px;    text-align: Center;    margin: 0 auto;'></p></div><p>${SHOWS}<br><span>Reg. nr.</span></p><p>${REKLAMOS_TIPAS}<br><span>Reklamos Tipas</span></p><p>${TURINYS}<br><span>Turinys</span></p><p>${REKLAMOS_PLOTAS}<br><span>Plotas m <sup>2</sup></span></p>"),P=new q("circle",24,new s(s.STYLE_LONGDASH,new t([223,52,59,1]),3),new t([255,255,255,0]));var R,S,T,U,V,W;R=new v({url:"https://zemelapiai.vplanas.lt/arcgis/rest/services/Interaktyvus_zemelapis/Reklamos_registro_leidimai/MapServer/0",distance:30,id:"clusters",labelColor:"#484848",resolution:a.extent.getWidth()/a.width,singleTemplate:N,useDefaultSymbol:!1,maxSingles:2e3,zoomOnClick:!0,showSingles:!0,outFields:["*"]}),S=new o(O,"clusterCount"),T=new q("circle",30,new s(s.STYLE_SOLID,new t([255,210,75,.4]),15),new t([255,210,75,.85])),U=new q("circle",40,new s(s.STYLE_SOLID,new t([255,210,75,.4]),15),new t([255,210,75,.85])),V=new q("circle",50,new s(s.STYLE_SOLID,new t([255,210,75,.4]),15),new t([255,210,75,.75])),W=new q("circle",60,new s(s.STYLE_SOLID,new t([255,210,75,.4]),15),new t([255,210,75,.85])),S.addBreak(2,50,T),S.addBreak(50,250,U),S.addBreak(250,1e3,V),S.addBreak(1e3,5e4,W),R.setRenderer(S),a.addLayer(R),c(R,"click",function(b){R.geometry=b.mapPoint,pxWidth=a.extent.getWidth()/a.width,padding=30*pxWidth,qGeom=new u({xmin:R.geometry.x-padding,ymin:R.geometry.y-padding,xmax:R.geometry.x+padding,ymax:R.geometry.y+padding,spatialReference:R.geometry.spatialReference}),R.geometry=qGeom});var X,Y;return a.infoWindow.on("selection-change",function(){D(),K()}),a.infoWindow.on("hide",function(){J(M,.75,.5),I()}),b=R}),b},buildingsTheme=function(a,b,c,d,e){require(["dijit/TooltipDialog","dijit/popup","dojo/mouse","dojo/_base/connect","esri/toolbars/navigation","esri/config","dojo/on","dojo/query","esri/layers/ArcGISTiledMapServiceLayer","esri/layers/ArcGISDynamicMapServiceLayer","esri/dijit/Legend","dojo/_base/array","dojo/parser","esri/dijit/Popup","esri/dijit/PopupTemplate","esri/InfoTemplate","esri/layers/FeatureLayer","dojo/_base/declare","dojo/promise/all","dojo/Deferred","dgrid/OnDemandGrid","dgrid/Selection","dojo/store/Memory","dijit/form/CheckBox","esri/tasks/query","esri/tasks/QueryTask","esri/symbols/SimpleMarkerSymbol","esri/renderers/SimpleRenderer","esri/Color","esri/request","dojo/dom","dojo/dom-construct","dojo/dom-class","esri/symbols/SimpleFillSymbol","esri/renderers/ClassBreaksRenderer","esri/dijit/Measurement","esri/units","esri/dijit/Geocoder","esri/symbols/SimpleLineSymbol","esri/geometry/Extent","app/clusterfeaturelayer","esri/graphic","esri/graphicsUtils","dojo/dom-style","dojo/_base/fx","dojo/fx/easing","dijit/registry","esri/dijit/Scalebar","esri/layers/LayerInfo","js/photoswipe.min.js","js/photoswipe-ui-default.min.js","dijit/layout/TabContainer","dijit/layout/BorderContainer","dijit/layout/ContentPane","dojo/domReady!"],function(f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M,N,O,P,Q,R,S,T,U,V,W,X,Y,Z,$,_,aa,ba){function ca(d){dijit.byId("selection-list")&&dijit.byId("selection-list").destroy(),window.location.hash="#close";var e=a.getMaxZoom()-1;a.centerAndZoom(d.mapPoint,e),ia.geometry=d.mapPoint,ha.execute(ia,da).then(function(){ga.createSelection()}),b.selectFeatures(ia,b.SELECTION_NEW),setTimeout(function(){window.location.hash="#build-data",c.deactivate()},100)}function da(h){function i(){switch(V){case 1:W="Savivaldybės paskirtas administratorius";break;case 2:W="Bendrija";break;case 3:W="JVS";break;case 6:W="Bendrija (statybos)";break;case 8:W="Nenustatyta valdymo forma";break;case 9:W="Neprižiūrimi pastatai";break;default:W="Nėra duomenų"}return W}function j(){var b;l(a,"mouse-move",function(a){jb&&("undefined"!=typeof b&&b.destroy(),b=new f({id:"myTooltipDialogCompare",style:"width: 160px;",content:"<p>Pažymėkite kitą pastatą palyginimui</p>",onMouseEnter:function(){g.close(b)}}),b.startup(),g.open({popup:b,x:a.pageX+10,y:a.pageY+10}))}),l(a,"mouse-out",function(){"undefined"!=typeof b&&b.destroy()})}function k(){function f(b){window.location.hash="#close";var d=a.getMaxZoom()-1;a.centerAndZoom(b.mapPoint,d),w.geometry=b.mapPoint,t.execute(w,g),n.selectFeatures(w,n.SELECTION_NEW),c.deactivate()}function g(a){var b=a.features[0].attributes;for(var c in b)if(b.hasOwnProperty(c)){b[c]||(b[c]="Nėra duomenų",Ya=b)}var d,e,f,g,h,i,j,k;j=b.NTRUNKNR,d=b.ADRESAS,k=b.ADMTARIF,f=b.BENDR_PLOT,e=b.ADMINISTR,g=b.ATLKMAX,h=b.NTPTMAX,i=b.NSPTMAX,ib="undefined"==typeof ib?ib="Nėra duomenų":ib;var l=u(j);l.then(function(a){var b="<div id='build-inner-stat-adm' class='section group animate'> <div class='colu span_1_of_3'><p ></p></div><div class='colu span_1_of_3 first-build'> <p><span>JŪSŲ PASTATAS</span></p></div> <div class='colu span_1_of_3 second-build'> <p><span>PASTATAS PALYGINIMUI</span></p></div><div class='colu span_1_of_3'><p class='normalf'>Adresas: </p></div> <div class='colu span_1_of_3' style='background: #F7F7F7;'><p>"+B+"</p></div><div class='colu span_1_of_3' style='background: #F7F7F7;'> <p>"+d+"</p></div><div class='colu span_1_of_3'><p class='normalf'>Žymėjimas: </p></div> <div class='colu span_1_of_3' style='background: #F7F7F7;'><p><span class='box first'></span></p> </div> <div class='colu span_1_of_3' style='background: #F7F7F7;'> <p><span class='box second'></span></p></div><div class='colu span_1_of_3'><p class='normalf'>Valdytojas: </p></div> <div class='colu span_1_of_3 vald' style='background: #F7F7F7;'><p>"+C+"</p> </div> <div class='colu span_1_of_3 vald' style='background: #F7F7F7;'> <p>"+e+"</p></div><div class='colu span_1_of_3'><p class='normalf'>Bendras plotas <br><b> (m²)</b>: </p> </div> <div class='colu span_1_of_3' style='background: #F7F7F7;'><p>"+Q+"</p> </div> <div class='colu span_1_of_3' style='background: #F7F7F7;'> <p>"+f+"</p></div><div class='colu span_1_of_3'> <p class='normalf'>Administracinis tarifas <br><b> (Eur/m²)</b>:</p> </div> <div class='colu span_1_of_3' style='background: #F7F7F7;'> <p>"+Pa+"</p> </div> <div class='colu span_1_of_3' style='background: #F7F7F7;'> <p>"+k+"</p></div><div class='colu span_1_of_3'> <p class='normalf'>Atliekų tarifas <b> (Eur/m²)</b>:</p> </div> <div class='colu span_1_of_3' style='background: #F7F7F7;'> <p>"+(null===ya?"Nėra duomenų":ya)+"</p> </div><div class='colu span_1_of_3' style='background: #F7F7F7;'> <p>"+g+"</p> </div> <div class='colu span_1_of_3'> <p class='normalf'>Techninės priežiūros tarifas <b> (Eur/m²)</b>:</p></div><div class='colu span_1_of_3' style='background: #F7F7F7;'><p>"+(null===Ha?"Nėra duomenų":Ha)+"</p> </div> <div class='colu span_1_of_3' style='background: #F7F7F7;'> <p>"+h+"</p></div> <div class='colu span_1_of_3'> <p class='normalf'>Šildymo sistemų priežiūros tarifas <b> (Eur/m²)</b>: </p> </div><div class='colu span_1_of_3' style='background: #F7F7F7;'><p>"+(null===Ka?"Nėra duomenų":Ka)+"</p> </div> <div class='colu span_1_of_3' style='background: #F7F7F7;'> <p>"+i+"</p></div><div class='colu span_1_of_3'> <p class='normalf'>Šildymo s. vidutinė mėn. šildymo kaina <b> (Eur/m²)</b>: </p> </div> <div class='colu span_1_of_3' style='background: #F7F7F7;'> <p>"+ib+"</p> </div> <div class='colu span_1_of_3' style='background: #F7F7F7;'> <p>"+a+"</p></div>";
console.log(b),J.byId("build-inner-stat-table").innerHTML=b,window.location.hash="#build-statistics"})}var h=document.createElement("div"),i=document.createElement("p"),k=J.byId("map");h.setAttribute("id","stats-close-button"),h.setAttribute("class","animate"),h.appendChild(i).innerHTML="Baigti palyginimą",k.appendChild(h),L.add("map","start-compare-hide"),L.add("myBarChart","hide"),L.remove("myBarChart","show"),L.add("bar-legend","hide"),L.remove("bar-legend","show"),jb=!0,window.location.hash="#close",L.add("start-compare","hide"),L.remove("start-compare","show"),L.add("bar-tips","hide"),L.remove("bar-tips","show"),tooltipCompare=j(),b.disableMouseEvents();var n=new v(d,{id:"buildings-compare",mode:v.MODE_ONDEMAND,outFields:["*"]}),o=new M(M.STYLE_SOLID,new R(R.STYLE_SOLID,new H([88,23,179,1]),3),new H([129,183,206,0]));n.setSelectionSymbol(o);var p=new M(M.STYLE_SOLID,new R(R.STYLE_SOLID,new H([78,78,78,0]),1),new H([195,219,159,0]));n.setRenderer(new G(p)),a.addLayer(n);var r=J.byId("stats-close"),s=J.byId("stats-close-button");r.addEventListener("click",function(){jb=!1,m(b,n)},!1),s.addEventListener("click",function(){jb=!1,m(b,n)},!1);var t=new E("https://zemelapiai.vplanas.lt/arcgis/rest/services/Interaktyvus_zemelapis/Pastatu_administravimas/MapServer/1"),w=new D;w.outSpatialReference={wkid:3346},w.returnGeometry=!1,w.outFields=["*"],e([n],q),l(n,"click",f)}function m(b,c){K.destroy("stats-close-button"),L.remove("map","start-compare-hide"),L.add("myBarChart","show"),L.remove("myBarChart","hide"),L.remove("start-compare","hide"),L.add("start-compare","show"),L.remove("bar-legend","hide"),L.add("bar-legend","show"),L.remove("bar-tips","hide"),L.add("bar-tips","show"),window.location.hash="#build-statistics",J.byId("build-inner-stat-table").innerHTML="",b.enableMouseEvents();var d=a.getLayer("buildings-compare");d&&(a.removeLayer(d),d={})}function n(a,b){var c=new XMLHttpRequest;c.open("HEAD",a,!0),c.send(),c.onreadystatechange=function(){if(4===c.readyState)return 404===c.status?(nb+=1,p(b,a),!1):(mb+=1,o(b,a),!0)}}function o(a,b){var c=document.createElement("p"),d=document.getElementById("build-inner-d");switch(a){case"ilgalaikisPlanas":ob.messagePlanas="<i class='fa fa-file-pdf-o'></i> <a href='"+b+"' target='_blank'>Ilgalaikis planas</a>",c.innerHTML=ob.messagePlanas,d.appendChild(c);break;case"ukinisPlanas":ob.messageUPlanas="<i class='fa fa-file-pdf-o'></i> <a href='"+b+"' target='_blank'>Ūkinis planas</a>",c.innerHTML=ob.messageUPlanas,d.appendChild(c);break;case"metineVeiklosAtaskaita":ob.messageAtaskaita="<i class='fa fa-file-pdf-o'></i> <a href='"+b+"' target='_blank'>"+z+" m. metinė veiklos ataskaita</a>",c.innerHTML=ob.messageAtaskaita,d.appendChild(c)}}function p(a,b){var c=document.createElement("p"),d=document.getElementById("build-inner-d");switch(a){case"ilgalaikisPlanas":ob.messagePlanas="<i class='fa fa-exclamation'></i>Nėra ilgalaikio plano duomenų",c.innerHTML=ob.messagePlanas,d.appendChild(c);break;case"ukinisPlanas":ob.messageUPlanas="<i class='fa fa-exclamation'></i>Nėra ūkinio plano duomenų",c.innerHTML=ob.messageUPlanas,d.appendChild(c);break;case"metineVeiklosAtaskaita":ob.messageAtaskaita="<i class='fa fa-exclamation'></i>Nėra metinės veiklos ataskaitos duomenų",c.innerHTML=ob.messageAtaskaita,d.appendChild(c)}}function r(a){var b=a.features,c=0;if(b.length>0)for(c;c<b.length;c+=1){var d="";d+=c,qb+="<p><span class='anchor-tag' href='' onclick='attachmentsObj["+c+"]("+c+")'>"+b[c].attributes.att_title+"</span></p>",attachmentsObj[d]=function(a){for(var c=b[a].attributes.att_contentType,d=atob(b[a].attributes.att_encodedContent),e="Aktas: "+b[a].attributes.att_title,f=new Array(d.length),g=0;g<d.length;g++)f[g]=d.charCodeAt(g);var h=new Uint8Array(f),i=new Blob([h],{type:c});saveAs(i,e)}}var e="<h3>"+B+"<br></h3>"+(""===qb?"<p>Priežiūros aktų nėra</p>":"<p>Atsisiųskite priežiūros aktus: </p>"+qb);J.byId("build-inner-att").innerHTML=e}function s(){var a=[];if($a.reduce(function(a,b){return a+b})>0){var b={label:"Atliekų tarifai",fillColor:"rgba(84,59,13, 0.4)",strokeColor:"rgba(212,203,188,1)",pointColor:"rgba(212,203,188,1)",pointStrokeColor:"#fff",pointHighlightFill:"#fff",pointHighlightStroke:"rgba(212,203,188,1)",data:$a};a.push(b)}if(_a.reduce(function(a,b){return a+b})>0){var b={label:"Lifto techninės priežiūros tarifai Eur/m²",fillColor:"rgba(151, 187, 205, 1)",strokeColor:"rgba(151, 187, 205, 1)",pointColor:"rgba(151, 187, 205, 1)",pointStrokeColor:"#fff",pointHighlightFill:"#fff",pointHighlightStroke:"rgba(151,187,205,1)",data:_a};a.push(b)}if(ab.reduce(function(a,b){return a+b})>0){var b={label:"Namo techninės priežiūros tarifai Eur/m²",fillColor:"rgba(154, 195, 146, 1)",strokeColor:"rgba(154, 195, 146, 1)",pointColor:"rgba(154, 195, 146, 1)",pointStrokeColor:"#fff",pointHighlightFill:"#fff",pointHighlightStroke:"rgba(220, 220, 220, 1)",data:ab};a.push(b)}if(bb.reduce(function(a,b){return a+b})>0){var b={label:"Namo šildymo sistemų priežiūros tarifai Eur/m²",fillColor:"rgba(222, 135, 71, 1)",strokeColor:"rgba(222, 135, 71, 1)",pointColor:"rgba(222, 135, 71, 1)",pointStrokeColor:"#fff",pointHighlightFill:"#fff",pointHighlightStroke:"rgba(222, 135, 71, 1)",data:bb};a.push(b)}return a}function t(a){var b=0,c=a.length,d=0;for(b;b<c;b+=1){if(a[b]&&"undefined"!=typeof a)return!0;d+=1}}function u(a){var b=new y;ka.where="NTRUNKNR = '"+a+"'",ka.returnGeometry=!1,ka.outFields=["*"];var c=ja.execute(ka);return c.then(function(a){var c=w(a);c.then(function(a){return b.resolve(a)})}),b.promise}function w(a){var b=new y,c=null;return setTimeout(function(){var d;if("undefined"==typeof a.features[0])Bb=!1,c="Nėra duomenų",b.resolve(c);else{Bb=!0;var e=a.features[0].attributes.METAIMAX,f=a.features,g=e,h=e-1,i=e-2,j=[],k={};k.einamiejiMetai=e;for(var l,m,n,o,p,q,r,s=0,t=f.length;s<t;s+=1){var u=a.features[s].attributes.SEZONAS;if(u===g||u===h||u===i)switch(j.push(u),l=a.features[s].attributes.SPAL_K,m=a.features[s].attributes.LAPKR_K,n=a.features[s].attributes.GRUOD_K,o=a.features[s].attributes.SAUS_K,p=a.features[s].attributes.VASAR_K,q=a.features[s].attributes.KOVAS_K,r=a.features[s].attributes.BALAN_K,u){case g:k.paskutiniaiMetai=[l,m,n,o,p,q,r];break;case h:k.viduriniaiMetai=[l,m,n,o,p,q,r];break;case i:k.galiniaiMetai=[l,m,n,o,p,q,r]}}var v=[k.paskutiniaiMetai,k.viduriniaiMetai,k.galiniaiMetai,k.einamiejiMetai];d=function(a){x.apply(null,a)},setTimeout(function(){"undefined"!=typeof k.paskutiniaiMetai&"undefined"!=typeof k.viduriniaiMetai&"undefined"!=typeof k.galiniaiMetai&&d(v)},50),jb?k.paskutiniaiMetai=c="undefined"==typeof k.paskutiniaiMetai?"Nėra duomenų":(k.paskutiniaiMetai.reduce(function(a,b){return a+b})/7).toFixed(3):"undefined"!=typeof k.paskutiniaiMetai&&(ib=k.paskutiniaiMetai.reduce(function(a,b){return a+b}),ib=(ib/7).toFixed(3)),b.resolve(c)}},50),b.promise}function x(a,b,c,d){function e(){l(dojo.byId("build-temp-bt"),"click",function(){var a=document.getElementById("myChart-heating").getContext("2d");window.myLineHeating=new Chart(a).Line(i,j,{responsive:!1});var b=myLineHeating.generateLegend();J.byId("chart-legend-heating").innerHTML="<p><b>ŠILUMOS GRAFIKAS:</b></p><p>Vidutinė mėnesinė šildymo kaina EUR/m²</p>"+b})}var f=d+1,g=d,h=d-1,i={labels:["Spalis","Lapkritis","Gruodis","Sausis","Vasaris","Kovas","Balandis"],datasets:[{label:g+"-"+f+" m. vidutinė šildymo kaina  EUR/m²",fillColor:"rgba(151, 187, 205, 0.6)",strokeColor:"rgba(151, 187, 205, 1)",pointColor:"rgba(151, 187, 205, 1)",pointStrokeColor:"#fff",pointHighlightFill:"#fff",pointHighlightStroke:"rgba(151,187,205,1)",data:a},{label:h+"-"+g+" m. vidutinė šildymo kaina EUR/m²",fillColor:"rgba(154, 195, 146, 0.6)",strokeColor:"rgba(154, 195, 146, 1)",pointColor:"rgba(154, 195, 146, 1)",pointStrokeColor:"#fff",pointHighlightFill:"#fff",pointHighlightStroke:"rgba(220, 220, 220, 1)",data:b},{label:h-1+"-"+h+" m. vidutinė šildymo kaina EUR/m²",fillColor:"rgba(222, 135, 71, 0.6)",strokeColor:"rgba(222, 135, 71, 1)",pointColor:"rgba(222, 135, 71, 1)",pointStrokeColor:"#fff",pointHighlightFill:"#fff",pointHighlightStroke:"rgba(222, 135, 71, 1)",data:c}]},j={scaleShowGridLines:!0,scaleShowLabels:!0,scaleGridLineColor:"rgba(0,0,0,.05)",scaleGridLineWidth:1,scaleShowHorizontalLines:!0,scaleShowVerticalLines:!0,bezierCurve:!0,bezierCurveTension:.4,pointDot:!0,pointDotRadius:6,pointDotStrokeWidth:1,pointHitDetectionRadius:20,datasetStroke:!0,datasetStrokeWidth:2,datasetFill:!1,tooltipCornerRadius:2,multiTooltipTemplate:"<%= value %> Eur/m² ",legendTemplate:'<div class="<%=name.toLowerCase()%>-legend"><% for (var i=0; i<datasets.length; i += 1){%><p><span style="background-color:<%=datasets[i].fillColor%>"></span><%if(datasets[i].label){%><%=datasets[i].label%><%}%></p><%}%></div>'};e()}"undefined"!=typeof myLine&&myLine.destroy(),"undefined"!=typeof myLineHeating&&myLineHeating.destroy();var z,A,B,C,F,I,N,O,P,Q,S,T,U,V,W,X,Y,Z,$,_,aa,ba,ca,da,ea,fa,ha,ia,la,ma,na,oa,pa,qa,ra,sa,ta,ua,va,wa,xa,ya,za,Aa,Ba,Ca,Da,Ea,Fa,Ga,Ha,Ia,Ja,Ka,La,Ma,Na,Oa,Pa,Qa,Ra,Sa,Ta,Ua,Va,Wa,Xa=h.features[0].attributes,Ya={};for(var Za in Xa)if(Xa.hasOwnProperty(Za)){Xa[Za]||("ATLKMAX"==Za||"ATLKMID"==Za||"ATLKMIN"==Za||"LTPTMAX"==Za||"LTPTMID"==Za||"LTPTMIN"==Za||"NTPTMAX"==Za||"NTPTMID"==Za||"NTPTMIN"==Za||"KITMAX"==Za||"KITMID"==Za||"KITMIN"==Za||"LKITMAX"==Za||"LKITMID"==Za||"LKITMIN"==Za||"NSPTMAX"==Za||"NSPTMID"==Za||"NSPTMIN"==Za?Ya=Xa:(Xa[Za]="Nėra duomenų",Ya=Xa))}z=Xa.METAIMAX,A="Nėra duomenų"==Xa.A_ADMINIKI?"Nėra duomenų":Xa.A_ADMINIKI_T,B=Xa.ADRESAS,N="Nėra duomenų"==Xa.STATMET?"Nėra duomenų":Xa.STATMET+" metai",O=Xa.STATPASK,P=Xa.NR_PLANE,Q=Xa.BENDR_PLOT,T=Xa.NAUD_PLOT,S=Xa.PATALPUGSK,U="Nėra duomenų"==Xa.PATALPUNSK?"Nėra":Xa.PATALPUNSK,Pa="Nėra duomenų"==Xa.ADMTARIF?"Nėra duomenų":Xa.ADMTARIF,Qa="Nėra duomenų"==Xa.SKL_PLOT?"Nėra duomenų":Xa.SKL_PLOT+" a",Ra=Xa.SAV_TEISES,Sa=Xa.NTRUNKNR,Ta=Sa.toString().substr(0,4)+"-"+Sa.toString().substr(4,4)+"-"+Sa.toString().substr(8),C=Xa.ADMINISTR,F=Xa.ADMINISTR_BUV||"Nėra duomenų",I=Xa.ADMINISTR_BUV_DAT,"undefined"==typeof I&&(I="Nėra duomenų"),V=Xa.VALDFORM,W=i(),X=Xa.A_ADRES,Y=Xa.A_PASKPAGR,Z=(1==V?"<p>"+Y+"<br><span><span class='bnov'>Vilniaus miesto savivaldybės administracijos įsakymas</span></span></p>":"")+(2==V?"<p>"+Y+"<br><span><span class='bnov'>BNOV  registravimo data  JAR‘e (Juridinių asmenų registras)</span></span></p>":"")+(3==V?"<p>"+Y+"<br><span><span class='bnov'>BNOV  registravimo data NTR‘e (Nekilnojamo turto registras)</span></span></p>":""),$=Xa.A_VADOVAS,_=Xa.A_VADTEL,ca=Xa.A_VADOVAS1,da=Xa.A_VADTEL1,ea=Xa.A_ELPAST1,fa=Xa.A_VADOVAS2,ha=Xa.A_VADTEL2,ia=Xa.A_ELPAST2,la=Xa.A_VADOVAS3,ma=Xa.A_VADTEL3,na=Xa.A_ELPAST3,oa=Xa.A_VADOVAS4,pa=Xa.A_VADTEL4,qa=Xa.A_ELPAST4,aa=Xa.NPVADYB,ba=Xa.A_VADYBTEL,bnovElP=Xa.A_ELPAST,ra=("Nėra duomenų"==ca?"":"<p>"+ca+"<br><span><span class='bnov'>BNOV</span> vadovas</span></p><p>"+da+"<br><span><span class='bnov'>BNOV</span> vadovo telefonas</span></p>"+("Nėra duomenų"==ea?"":"<p>"+ea+"<br><span><span class='bnov'>BNOV</span> vadovo el. paštas</span></p>"))+("Nėra duomenų"==fa?"":"<p>"+fa+"<br><span><span class='bnov'>BNOV</span> vadovas</span></p><p>"+ha+"<br><span><span class='bnov'>BNOV</span> vadovo telefonas</span></p>"+("Nėra duomenų"==ia?"":"<p>"+ia+"<br><span><span class='bnov'>BNOV</span> vadovo el. paštas</span></p>"))+("Nėra duomenų"==la?"":"<p>"+la+"<br><span><span class='bnov'>BNOV</span> vadovas</span></p><p>"+ma+"<br><span><span class='bnov'>BNOV</span> vadovo telefonas</span></p>"+("Nėra duomenų"==na?"":"<p>"+na+"<br><span><span class='bnov'>BNOV</span> vadovo el. paštas</span></p>"))+("Nėra duomenų"==oa?"":"<p>"+oa+"<br><span><span class='bnov'>BNOV</span> vadovas</span></p><p>"+pa+"<br><span><span class='bnov'>BNOV</span> vadovo telefonas</span></p>"+("Nėra duomenų"==qa?"":"<p>"+qa+"<br><span><span class='bnov'>BNOV</span> vadovo el. paštas</span></p>")),sa=Xa.A_KODAS,ta="Nėra duomenų"==Xa.SKUNDUSK?"Nėra duomenų":Xa.SKUNDUSK+" vnt.",ua=Xa.SKUNDPOB,va="Nėra duomenų"==Xa.ENEFKL?"Nėra duomenų":Xa.ENEFKL+" klasė",wa="Nėra duomenų"==Xa.RENOVMET?"Nėra duomenų":Xa.RENOVMET+" metai",xa=Xa.RENOVUOTA,ya=Xa.ATLKMAX,za=Xa.ATLKMID,Aa=Xa.ATLKMIN,Ba=Xa.LTPTMAX,Ca=Xa.LTPTMAX,Da=Xa.LTPTMID,Ea=Xa.LTPTMIN,Ha=Xa.NTPTMAX,Ga=Xa.NTPTMID,Fa=Xa.NTPTMIN,Ka=Xa.NSPTMAX,Ja=Xa.NSPTMID,Ia=Xa.NSPTMIN,Oa="Nėra duomenų"==Xa.SUKAUPTA?"Nėra duomenų":Xa.SUKAUPTA+" Eur",Na=Xa.KITMAX,Ma=Xa.KITMID,La=Xa.KITMIN,kaupTar=null===Na?"Nėra duomenų":Na+" Eur/m²",Ua=Xa.NTPRIZ,Va=Xa.NSPRIZ,Wa=Xa.LTPRIZ;var $a=([V,X,Y,$,_,aa,ba,bnovElP,sa,ta,ua],[Aa,za,ya]),_a=[Ea,Da,Ca],ab=[Fa,Ga,Ha],bb=[Ia,Ja,Ka],cb="<h3>"+B+"</h3><p>"+Ta+"<br><span>Unikalus numeris</span></p><p>"+N+"<br><span>Statybos metai</span></p><p>"+P+"<br><span>Korpusas</span></p><p>"+O+"<br><span>Namo paskirtis</span></p><p class='build-bt build-top'><a href='#build-info' class='animate'>Bendroji informacija</a></p><p class='build-bt'><a href='#build-manage' class='animate'>Valdytojų informacija</a></p><p class='build-bt'><a href='#build-temp' id='build-temp-bt' class='animate'>Šildymo duomenys / Renovacija</a></p><p class='build-bt'><a href='#build-maintenance' class='animate'>Namo priežiūros tarifai</a></p><p class='build-bt'><a href='#build-docs' class='animate'>Ataskaitos ir planai</a></p><p class='build-bt'><a href='#build-attachments' class='animate'>Priežiūros aktai</a></p><p class='build-bt'><a href='#build-statistics' class='animate'>Tarifų palyginimas</a></p><p class='build-bt'><a href='#build-help' class='animate'>Pagalba ir duomenų suvedimas</a></p><p class='build-bt'><a href='#build-imp-info' class='animate'>Svarbi informacija</a></p>";J.byId("build-inner").innerHTML=cb;var db="<h3>"+B+"</h3><p>"+Q+" m²<br><span>Bendras plotas</span></p><p>"+T+" m²<br><span>Naudingasis plotas</span></p><p>"+S+"<br><span>Gyvenamų patalpų skaičius</span></p><p>"+U+"<br><span>Negyvenamų patalpų skaičius</span></p><p>"+Qa+"<br><span>Sklypo plotas arais</span></p><p>"+Ra+"<br><span>Namui priskirto žemės sklypo patalpų savivinkų teisės</span></p>";J.byId("build-inner-i").innerHTML=db;var eb="<h3>"+B+"<br></h3><p>"+W+" <br><span>Valdymo forma</span></p><p>"+C+" <br><span>"+("JVS"==W?"Jungtinės veiklos sutartimi valdomas namas":"<span class='bnov'>BNOV administratorius</span>")+"<br><span class='bnov'>BNOV (Bendrojo naudojimo objektų valdytojas)</span></span></p><p>"+A+" <br><span>administratoriaus paskyrimo terminas</span></p><p>"+X+"<br><span><span class='bnov'>BNOV</span> adresas</span></p>"+Z+"<p>"+$+"<br><span><span class='bnov'>BNOV</span> vadovas</span></p><p>"+_+"<br><span><span class='bnov'>BNOV</span> vadovo telefonas</span></p>"+ra+"<p>"+aa+"<br><span>Namo priežiūros vadybininkas:</span></p><p style='display:none;'>"+ba+"<br><span>Namo priežiūros vadybininko telefonas</span></p><p>"+ta+"<br><span><span class='bnov'>BNOV</span> gaunamų skundų skaičius</span></p><p>"+ua+"<br><span><span class='bnov'>BNOV</span> gaunamų skundų pobūdis</span></p><p>"+sa+" <br><span><span class='bnov'>BNOV</span> kodas</span></p><p><a href='mailto:"+bnovElP+"' class='email'>"+bnovElP+"</a><br><span><span class='bnov'>BNOV</span> el. paštas</span></p><span><p class='info-highlight'><i class='fa fa-exclamation' style='color: #C1272D;'></i>Informacija apie <a href='http://www.vilnius.lt/index.php?4265980094' class='email' target='_blank'>bendrijų steigimą</a></p></span>";J.byId("build-inner-mng").innerHTML=eb;var fb="<h3>"+B+"<br></h3><p>"+va+"<br><span>Namo energetinis efektyvumas</span></p><p>"+wa+"<br><span>Renovacijos metai</span></p><p>"+xa+"<br><span>Kas renovuota</span></p>";J.byId("build-inner-t-msg").innerHTML=fb;var gb="<h3>"+B+"</h3><p>"+Ua+"<br><span>Namo techninis prižiūrėtojas</span></p><p>"+Va+"<br><span>Namo šildymo sistemos techinis prižiūrėtojas</span></p><p>"+Wa+"<br><span>Lifto techninis prižiūrėtojas</span></p><p>"+("number"==typeof Pa?Pa+" Eur/m²":Pa)+"<br><span>Administracinis tarifas</span></p><p>"+kaupTar+"<br><span>Kaupiamosios įmokos tarifas</span></p><p>"+Oa+"<br><span>Sukauptos lėšos</span></p>";J.byId("build-inner-m-msg").innerHTML=gb;var hb="<h3>"+B+"</h3><h4>Dviejų pastatų palyginimas:</h4><div id='compare-btn-block'><span id='start-compare' class='compare'><p>Norėdami  palyginti du skirtingu pastatus, spūstelkite žemiau esantį mygtuką ir palyginimui žemėlapyje pažymėkite naują pastatą .</p><div id='compare-btn' class='bt animate'><a class='button'><i class='fa fa-angle-left' aria-hidden='true'></i>Pasirinkite kitą pastatą palyginimui</a></div><h4 class='border-top'>Sužinokite skirtingų administratorių tarifų vidurkius:</h4><div id='selection-list'></div></span><div id='build-inner-stat-table'></div></div><div id='bar-legend'></div><canvas id='myBarChart' width='433' height='833'></canvas><div id='bar-tips'></div>";J.byId("build-inner-stat").innerHTML=hb;var ib,jb=!1,kb=J.byId("compare-btn");kb.addEventListener("click",k,!1);var lb={ilgalaikisPlanas:"https://zemelapiai.vplanas.lt/Statiniai/Adm_Stat/"+(parseInt(z,10)-1)+"/IP_"+Sa+".pdf",ukinisPlanas:"https://zemelapiai.vplanas.lt/Statiniai/Adm_Stat/"+(parseInt(z,10)-1)+"/P_"+Sa+".pdf",metineVeiklosAtaskaita:"https://zemelapiai.vplanas.lt/Statiniai/Adm_Stat/"+(parseInt(z,10)-1)+"/AT_"+Sa+".pdf"},mb=0,nb=0,ob={messagePlanas:"",messageUPlanas:"",messageAtaskaita:""};for(var pb in lb)lb.hasOwnProperty(pb)&&n(lb[pb],pb);window.attachmentsObj={};var qb="",rb=new E("https://zemelapiai.vplanas.lt/arcgis/rest/services/Interaktyvus_zemelapis/Pastatu_administravimas/MapServer/5"),sb=new D;sb.outSpatialReference={wkid:3346},sb.where="fld_unikalus_nr1= '"+Sa+"' OR fld_unikalus_nr2= '"+Sa+"' OR fld_unikalus_nr3= '"+Sa+"'",sb.returnGeometry=!1,sb.outFields=["*"],rb.execute(sb,r);var tb="<h3>"+B+"<br></h3>";J.byId("build-inner-d").innerHTML=tb;var ub="<h3>"+B+"<br></h3><p>Turite pasiūlymų ar pastabų? Matote klaidų?</p> <p>Susisiekite el. paštu: <a href='mailto:pastatai@vilnius.lt'>pastatai@vilnius.lt</a></p><p>Norėdami pateikti duomenys apie konkretų pastatą, kviečiame užpildyti <a href='https://zemelapiai.vplanas.lt/Statiniai/Adm_Stat/lentele.xlsx'>duomenų suvedimo lentelę</a> ir persiųsti aukščiau nurodytu el. pašto adresu.</p><p>Informacija apie <a href='http://www.vilnius.lt/index.php?4265980094' target='_blank'>bendrijų steigimą</a></p>";J.byId("build-inner-h").innerHTML=ub;var vb="<h3>"+B+"<br></h3><p><a href='http://www.vilnius.lt/index.php?4265980094' target='_blank'> Bendrijų steigimas </a></p><p><a href='http://www.vilnius.lt/index.php?1568645331' target='_blank'>Jungtinės veiklos sutarties sudarymas</a></p><p><a href='http://www.vilnius.lt/index.php?4278773191' target='_blank'>Administratoriaus keitimas</a></p>";if(J.byId("build-inner-imp-i").innerHTML=vb,t($a)||t(_a)||t(ab)||t(bb)){var wb={labels:[z-2+" metai",z-1+" metai",z+" metai"],datasets:s()},xb={scaleShowGridLines:!0,scaleShowLabels:!0,scaleGridLineColor:"rgba(0,0,0,.05)",scaleGridLineWidth:1,scaleShowHorizontalLines:!0,scaleShowVerticalLines:!0,bezierCurve:!0,bezierCurveTension:.4,pointDot:!0,pointDotRadius:6,pointDotStrokeWidth:1,pointHitDetectionRadius:20,datasetStroke:!0,datasetStrokeWidth:2,datasetFill:!1,tooltipCornerRadius:2,multiTooltipTemplate:"<%= value %> Eur/m² ",legendTemplate:'<div class="<%=name.toLowerCase()%>-legend"><% for (var i=0; i<datasets.length; i += 1){%><p><span style="background-color:<%=datasets[i].fillColor%>"></span><%if(datasets[i].label){%><%=datasets[i].label%><%}%></p><%}%></div>'+("Nėra duomenų"!=I?"<span><p><strong>"+new Date(I).getFullYear()+" m.</strong> paskirtas naujas administratorius - <strong>"+C+"</strong> (buvęs administratorius - "+F+")</p></span>":"")},yb=document.getElementById("myChart").getContext("2d");window.myLine=new Chart(yb).Line(wb,xb,{responsive:!1});var zb=myLine.generateLegend();J.byId("chart-legend").innerHTML="<p><b>TARIFŲ GRAFIKAS:</b></p>"+zb}else{var Ab=document.getElementById("chart-legend");Ab.innerHTML="<p>Nėra duomenų apie priežiūros tarifus</p>"}u(Sa);var Bb;if(!Bb){var Cb=document.getElementById("chart-legend-heating");Cb.innerHTML="<p>Nėra duomenų apie šilumos tarifus</p>"}setTimeout(function(){var a=dijit.byId("selection-list");a.on("change",function(a){"none"!==a?(ga.setQuery(a,C),L.add("bar-legend","show"),L.remove("bar-legend","hide"),L.add("bar-tips","show"),L.remove("bar-tips","hide")):(myBar.destroy(),J.byId("bar-legend").innerHTML="",J.byId("bar-tips").innerHTML="",L.add("bar-legend","hide"),L.remove("bar-legend","show"),L.add("bar-tips","hide"),L.remove("bar-tips","show"))})},1e3)}var ea=document.querySelectorAll(".pswp")[0],fa=document.getElementById("building-help");fa.addEventListener("click",function(){var a=[{src:"/maps_vilnius/img/help_1.png",title:"1. Adresų paieškos lauko arba navigacijos meniu (jei ieškote tiesiogiai žemėlapyje) pagalba priartinkite žemėlapio vaizdą kol matysite pastatų kontūrus",w:1408,h:828},{src:"/maps_vilnius/img/help_2.png",title:"2. Pažymėkite konkretų pastatą, dešinėje atsidarusiame lange rasite visą turimą pastato informaciją bei paryškintas potemes",w:1408,h:828},{src:"/maps_vilnius/img/help_3.png",title:'3. Norėdami palyginti pastatų tarifus, pasirinkite "Tarifų palyginimas" potemę',w:1408,h:828},{src:"/maps_vilnius/img/help_4.png",title:'4. Norėdami palyginti dviejų pastatų tarifus, spūstelkite mygtuką "Pasirinkite pastatą palyginimui" ',w:1408,h:828},{src:"/maps_vilnius/img/help_5.png",title:"5. Pelės pagalba pažymėkite naują pastatą palyginimui",w:1408,h:828},{src:"/maps_vilnius/img/help_6.png",title:'6. Pažymėjus pastatą palyginimui, dešinėje atsidarusiame lange rasite dviejų pastatų turimų tarifų lentelę. Norėdami nutraukti palyginimą spūtelkite mygtuką "Atgal"',w:1408,h:828},{src:"/maps_vilnius/img/help_7.png",title:'7. Norėdami palyginti visų administratorių pastatų tarifų vidurkius, spūstelkite opciją "Pasirinkite palyginamąjį vidutinį tarifą" bei pažymėkite konkretų tarifą ',w:1408,h:828},{src:"/maps_vilnius/img/help_8.png",title:"8. Pažymėjus konkretų tarifą grafike matysite administratorių vidutinius vidurkius. PASTABA: bendrijų ir JVS duomenis nėra tikslūs",w:1408,h:828}],b={showAnimationDuration:200,errorMsg:'<div class="pswp__error-msg"><a href="%url%" target="_blank">Įvyko klaida.</a> Atsiprašome galerija nepasiekiama.</div>',index:0},c=new aa(ea,ba,a,b);c.init()});var ga={bendrijosColor:"rgba(115, 178, 255, 1)",jvsColor:"rgba(115, 255, 223, 1)",admColor:"rgba(168, 226, 251, 1)",createSelection:function(){return require(["dijit/form/Select"],function(a){var b=new a({name:"selectGraph",options:[{label:"Pasirinkite palyginamajį vidutinį tarifą:",value:"none",selected:!0},{label:"Administracinis tarifas (Eur/m²)",value:"adm"},{label:"Techninės priežiūros tarifas (Eur/m²)",value:"tech"},{label:"Šildymo sistemų priežiūros tarifas (Eur/m²)",value:"sist"},{label:"Atliekų tarifas (Eur/m²)",value:"atl"}]},"selection-list");b.startup()})},setQuery:function(a,b){var c=new y,d=new D,e=new E("https://zemelapiai.vplanas.lt/arcgis/rest/services/Interaktyvus_zemelapis/Pastatu_administravimas/MapServer/4"),f=this;return d.where="1=1",d.returnGeometry=!1,d.outFields=["*"],e.execute(d).then(function(d){var e=f.showGraphData(d,a,b);c.resolve(e)}),c.promise},showGraphData:function(a,b,c){var d,e=[],f=[],g=[],h=[],i=[],j=[],k=[],l=[],m=[],n=0;for(n;n<a.features.length;n+=1)switch(d=a.features[n].attributes,e.push(d.VALDF_GR),f.push(d.VALDF_GR_T),g.push(d.Namo_administracinis),h.push(d.Atliekos),i.push(d.Tech_priez),j.push(d.Sild_sist_priez),k.push(d.Sildymas),d.VALDF_GR){case 2:l.push(this.bendrijosColor),m.push("rgba(0, 112, 255, 1)");break;case 3:l.push(this.jvsColor),m.push("rgba(0, 168, 132, 1)");break;default:l.push(this.admColor),m.push("rgba(136, 187, 216, 1)")}var o={labels:e,labelsStr:f,admT:g,atliek:h,techP:i,sildP:j,sildVid:k,bgColour:l};this.showGraphics(o,b);for(var p=0;p<myBar.datasets[0].fillColor.length;p+=1){myBar.datasets[0].bars[p].fillColor=l[p];myBar.datasets[0].bars[p].label;c===myBar.datasets[0].bars[p].label?myBar.datasets[0].bars[p].strokeColor="red":myBar.datasets[0].bars[p].strokeColor=m[p],myBar.datasets[0].bars[p].strokeWidth=1}myBar.update()},showGraphics:function(a,b){"undefined"!=typeof myBar&&myBar.destroy();var c;switch(b){case"adm":c=a.admT;break;case"tech":c=a.techP;break;case"sist":c=a.sildP;break;case"sild":c=a.sildVid;break;case"atl":c=a.atliek}var d={labels:a.labelsStr,datasets:[{fillColor:a.bgColour,borderColor:a.bgColour,borderWidth:1,highlightFill:"#F7F7F7",highlightStroke:"rgba(159, 159, 159, 0.91)",data:c,yAxisID:"y-axis-0"}]},e={scaleLineColor:"rgba(0,0,0,.4)",showScale:!0,scaleFontSize:12,scaleFontColor:"#555",scaleShowLabels:!0,scaleLabel:"<%=value%>",tooltipCornerRadius:2,tooltipTemplate:"<%= label%>: <%= value + ' Eur/m²'%>",scaleSteps:1,barValueSpacing:1,responsive:!1},f=document.getElementById("myBarChart").getContext("2d");window.myBar=new Chart(f).Bar(d,e);for(var g=myBar.datasets[0].fillColor,h=g.getUnique(),i="",j=0;j<g.length;j+=1)h[j]===this.admColor&&(i+="<p><span style='background-color:"+h[j]+" '></span>Administratoriai</p>"),h[j]===this.bendrijosColor&&(i+="<p><span style='background-color:"+h[j]+" '></span>Bendrijos</p>"),h[j]===this.jvsColor&&(i+="<p><span style='background-color:"+h[j]+" '></span>JVS</p>");J.byId("bar-legend").innerHTML="<div id='chart-legend'><div class='line-legend'>"+i+"</div></div>",J.byId("bar-tips").innerHTML="<div id='chart-legend'><div class='line-legend'><h5><i class='fa fa-exclamation' style='color: #C1272D; height: auto'></i>Dėl bendrijų ir JVS vidutinių tarifų:</h5><p>Bendrijų ir JVS duomenys nėra tikslūs, nes informacija apie tarifus pateikta mažiau kaip 50 proc. bendrijų arba  jungtinės veiklos sutartimi  valdomų namų.</br>Sprendimas  dėl įmokų tarifų dydžio priimamas Civilinio kodekso 4.85 straipsnyje nustatyta tvarka</p><p><i class='fa fa-exclamation' style='color: #C1272D; height: auto'></i>Duomenys atliekų tarifo grafike pateikiami neįvertinus atliekų tvarkymo paskirstymo skaičiavimo būdo. Bendrijų ir JVS valdomų daugiabučių namų butų ir kitų patalpų savininkams mokestis už atliekų tvarkymą skaičiuojamas ne tik nuo buto naudingo  ploto, bet ir nuo gyventojų skaičiaus bute. Sprendimas priimamas Civilinio kodekso 4.85 straipsnyje nustatyta tvarka.</p></div></div>"}},ha=new E("https://zemelapiai.vplanas.lt/arcgis/rest/services/Interaktyvus_zemelapis/Pastatu_administravimas/MapServer/1"),ia=new D;ia.outSpatialReference={wkid:3346},ia.returnGeometry=!1,ia.outFields=["*"];var ja,ka=new D;setTimeout(function(){ja=new E("https://zemelapiai.vplanas.lt/arcgis/rest/services/Interaktyvus_zemelapis/Pastatu_administravimas/MapServer/2")},150);var la=new M(M.STYLE_SOLID,new R(R.STYLE_SOLID,new H([193,39,45,1]),3),new H([129,183,206,0]));b.setSelectionSymbol(la);var ma=new M(M.STYLE_SOLID,new R(R.STYLE_SOLID,new H([78,78,78,0]),1),new H([195,219,159,0]));b.setRenderer(new G(ma)),a.addLayer(b),l(b,"click",ca);var na;l(b,"mouse-move",function(a){"undefined"!=typeof na&&na.destroy(),na=new f({id:"myTooltipDialog",style:"width: 160px;",content:"<p>Pažymėkite pastatą</p>",onMouseEnter:function(){g.close(na)}}),na.startup(),g.open({popup:na,padding:{x:10,y:10},x:a.pageX,y:a.pageY})}),l(b,"mouse-out",function(){na.destroy()})})},schoolsTheme=function(a,b,c,d,e,f,g){require(["dojo/i18n!esri/nls/jsapi","dijit/TooltipDialog","dijit/popup","esri/dijit/Search","esri/tasks/locator","esri/symbols/PictureMarkerSymbol","esri/layers/GraphicsLayer","dojo/_base/connect","esri/toolbars/navigation","esri/config","dojo/on","dojo/query","esri/layers/ArcGISTiledMapServiceLayer","esri/layers/ArcGISDynamicMapServiceLayer","esri/dijit/Legend","dojo/_base/array","dojo/parser","esri/dijit/Popup","esri/dijit/PopupTemplate","esri/InfoTemplate","esri/layers/FeatureLayer","dojo/_base/declare","dojo/promise/all","dojo/Deferred","dgrid/OnDemandGrid","dgrid/Selection","dijit/form/Select","dojo/store/Memory","dijit/form/CheckBox","esri/tasks/query","esri/tasks/QueryTask","esri/symbols/SimpleMarkerSymbol","esri/renderers/SimpleRenderer","esri/renderers/UniqueValueRenderer","esri/Color","esri/request","dojo/dom","dojo/dom-construct","dojo/dom-class","esri/symbols/SimpleFillSymbol","esri/renderers/ClassBreaksRenderer","esri/dijit/Measurement","esri/units","esri/dijit/Geocoder","esri/symbols/SimpleLineSymbol","esri/geometry/Extent","app/clusterfeaturelayer","esri/graphic","esri/graphicsUtils","dojo/dom-style","dojo/_base/fx","dojo/fx/easing","dijit/registry","esri/dijit/Scalebar","esri/layers/LayerInfo","dijit/layout/TabContainer","dijit/layout/BorderContainer","dijit/layout/ContentPane","dojo/domReady!"],function(b,c,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M,N,O,P,Q,R,S,T,U,V,W,X,Y,Z,$,_,aa,ba,ca,da,ea,fa){function ga(){Ja.search()}function ha(b){var c=Fa.selectFeatures(b,z.SELECTION_NEW,function(b){var c=b[0].attributes,d=c.ADRESAS,e=c.KALBA,f=c.VARDAS,g=c.TIPAST,h=new y(Ca,i),i="<p class='bord'>"+f+" <br><span>Mokyklos pavadinimas</span></p><p class='bord'>"+d+"<br><span>Adresas</span></p><p class='bord'>"+e+"<br><span>Kalba</span></p><p class='school-type' class='bord'>"+g+"<br><span>Mokyklos tipas</span></p>";ia(b[0].geometry,b[0].attributes),h.setContent(i),a.infoWindow.show(b[0].geometry),a.centerAt(b[0].geometry)});a.infoWindow.setFeatures([c])}function ia(b,c){ja();var d=new l;d.id="Points selection",d.add(new $(b,ya,c)),setTimeout(function(){a.addLayer(d)},100),ra(d)}function ja(b){var c=a.getLayer("Points selection"),d=a.getLayer("Polygon selection"),e=a.getLayer("Feature points selection");c&&(a.removeLayer(c),c={}),e&&(a.removeLayer(e),e={}),d&&!b&&(a.removeLayer(d),d={})}function ka(a){var b,c=na("language-filter"),d=na("year-filter"),e=ma(d),f=pa(c),g=oa(e);b=la(c,f,d,g),La.geometry=a.result.feature.geometry,La.where=b,Ka.execute(La,qa)}function la(a,b,c,d){return 1==a.length&&0===a[0]&&1==c.length&&0===c[0]?"1=1":0!==a[0]&&0!==c[0]?"("+b+") AND ("+d+")":0===a[0]&&0!==c[0]?d:0!==a[0]&&0===c[0]?b:void 0}function ma(a){return a>0&&a<5?["Sraut_0104"]:a>4&&a<9?["Sraut_0508"]:a>8&&a<11?["Sraut_0910","Sraut_0912"]:a>8&&a<13?["Sraut_0912"]:[0]}function na(a){var b=dijit.byId(a);return b.get("value")}function oa(a){return 1==a.length?0!==a[0]?a[0]+"='1'":"1=1":a[0]+"='1' OR "+a[1]+"='1'"}function pa(a){return 1==a.length?0!==a[0]?"KALBA = '"+a[0]+"'":"1=1":"KALBA = '"+a[0]+"' OR KALBA='"+a[1]+"'"}function qa(b){var c="",e=0;for(e;e<b.features.length;e+=1)b.features[e].attributes.OBJ_ID&&(c+=b.features.length-1-e===0?"OBJ_ID = '"+b.features[e].attributes.OBJ_ID+"'":"OBJ_ID = '"+b.features[e].attributes.OBJ_ID+"' OR ");var f=new I;f.where=c,f.outFields=["*"];var h=new K("circle",22,new X(X.STYLE_SOLID,new N([132,0,168,.9]),2),new N([232,190,255,1]),1),i=new K("circle",22,new X(X.STYLE_SOLID,new N([0,106,68,.9]),2),new N([74,181,90,1]),1),j=new K("circle",22,new X(X.STYLE_SOLID,new N([0,112,255,.9]),2),new N([115,178,255,1]),1),k=new K("circle",22,new X(X.STYLE_SOLID,new N([220,20,60,.9]),2),new N([255,127,127,1]),1),m=new K("circle",22,new X(X.STYLE_SOLID,new N([220,20,60,.9]),2),new N([255,255,255,1]),1),n=new K("circle",22,new X(X.STYLE_SOLID,new N([122,122,0,.9]),2),new N([167,167,0,1]),1);Fa.selectFeatures(f,z.SELECTION_NEW,function(b){function c(a,b){var c=a.attributes.VARDAS;c&&(A+='<li class="'+b+'"><button id="'+a.attributes.OBJ_ID+" "+a.attributes.OBJECTID+'" class="animate">'+c+"</button></li>")}function e(a){return Math.max.apply(null,a)}function f(a){return Math.min.apply(null,a)}function o(a){a.stopPropagation();var b=a.graphic.attributes,c=b.OBJ_ID.toString()+" "+b.OBJECTID.toString(),d=document.getElementById(c),e=new I;e.where="OBJECTID="+b.OBJECTID,e.outFields=["*"],ha(e),r(),ia(a.graphic.geometry,a.graphic.attributes),s(a.graphic.attributes.OBJ_ID),R.add(d,"focus")}function q(a){var b=new I,c=a.target.id,d=c.split(" ");r(),b.where="OBJECTID="+d[1],b.outFields=["*"],ha(b),s(d[0]),R.add(a.target,"focus")}function r(){u.forEach(F,function(a,b){R.remove(a,"focus")})}function s(a){var b=new I,c=na("year-filter"),d=ma(c),e=oa(d);"none"===c?b.where="OBJ_ID="+a:b.where="OBJ_ID="+a+" AND ("+e+")",
b.outSpatialReference={wkid:3346},b.returnGeometry=!0,b.outFields=["*"],Ka.execute(b,t)}function t(a){if(1===a.features.length)v(a.features[0].geometry);else{var b=a.features.map(function(a){return a.geometry});g.union(b,function(a){v(a)})}}function v(b){var c=new l;c.id="Polygon selection",c.add(new $(b,za)),setTimeout(function(){a.addLayer(c,0)},100)}var w=a.getLayer("Mokyklos");w&&(a.removeLayer(w),w={}),w=new l,w.id="Mokyklos",xa=b.length;var x=P.byId("schools-data");x.innerHTML="<p class='address'>"+va+"<br><span>Rastas adresas</span></p><p class='school-count'><span class='school-no'>"+xa+"</span> <br><span>Pagal rastą adresą priskirtas mokyklų skaičius</span></p>",Fa.setOpacity(.6);var y=[],z=[],A="",B=document.getElementById("schools-filtered-list");u.forEach(b,function(a){var b=a.attributes.KALBA;26===a.attributes.GYV_ID&&(b="26");var d="";switch(y.push(a.geometry.x),z.push(a.geometry.y),b){case"lietuvių":w.add(new $(a.geometry,i,a.attributes)),d+="lie";break;case"rusų":w.add(new $(a.geometry,j,a.attributes)),d+="rus";break;case"lenkų":w.add(new $(a.geometry,k,a.attributes)),d+="len";break;case"rusų lenkų":w.add(new $(a.geometry,m,a.attributes)),d+="rus-len";break;case"lenkų rusų":w.add(new $(a.geometry,m,a.attributes)),d+="len-rus";break;case"26":w.add(new $(a.geometry,n,a.attributes)),d+="spec";break;default:w.add(new $(a.geometry,h,a.attributes))}c(a,d)}),Q.place(A,B,"last"),setTimeout(function(){R.add(P.byId("schools-list"),"active")},200),y.push(wa.x),z.push(wa.y);var C=30*Aa,D=new esri.geometry.Extent({xmin:f(y)-C,ymin:f(z)-C,xmax:e(y)+C,ymax:e(z)+C,spatialReference:{wkid:3346}});a.setExtent(D,!0),setTimeout(function(){a.addLayer(w)},1e3),d([w],u),p(w,"click",function(a){o(a)});var E=document.getElementById("schools-filtered-list"),F=E.getElementsByTagName("button");u.forEach(F,function(a,b){a.addEventListener("click",q,!0)}),ra(w)})}function ra(a){var b;p(a,"mouse-move",function(a){var d=a.graphic.attributes,e=d.VARDAS;"undefined"!=typeof b&&b.destroy(),b=new c({id:"myTooltipDialogFeature",style:"width: 160px;",content:"<p>"+e+"</p>",onMouseEnter:function(){h.close(b)}}),b.startup(),h.open({popup:b,x:a.pageX+2,y:a.pageY+2})}),p(a,"mouse-out",function(){b.destroy()})}function sa(b){var c=a.getLayer("Points selection"),d=a.getLayer("Feature points selection");c&&(a.removeLayer(c),c={}),d&&(a.removeLayer(d),d={});var e=new l;e.id="Feature points selection",e.add(new $(b.graphic.geometry,ya,b.graphic.attributes)),setTimeout(function(){a.addLayer(e)},100),ra(e)}function ta(){var a=q(".dijitCheckBoxInput"),b=[];u.forEach(a,function(c){c.checked&&(b.push(c.id),b.push(0)),a[0].checked?(Fa.show(),Ga.show()):(Fa.hide(),Ga.hide())}),0===b.length&&b.push(-1),Ga.setVisibleLayers(b);var c={layer:Ga};legendDijit.refresh([c])}var ua=[],va="",wa={},xa="",ya=new K("circle",36,new X(X.STYLE_LONGDASH,new N([193,39,45,1]),3),new N([255,255,255,0]),1),za=new S(S.STYLE_SOLID,new X(X.STYLE_SOLID,new N([193,39,45,0]),3),new N([47,47,47,.6])),Aa=a.extent.getWidth()/a.width,Ba="<p class='bord'>${VARDAS}<br><span>Mokyklos pavadinimas</span></p><p class='bord'>${ADRESAS}<br><span>Adresas</span></p><p class='bord'>${KALBA}<br><span>Kalba</span></p><p class='school-type' class='bord'>${TIPAST}<br><span>Mokyklos tipas</span></p>",Ca="Ugdymo įstaigos duomenys",Da=new y(Ca,Ba),Ea="https://zemelapiai.vplanas.lt/arcgis/rest/services/Interaktyvus_zemelapis/Mokyklos/MapServer/0",Fa=new z(Ea,{id:"school-feature-point",infoTemplate:Da,mode:z.MODE_ONDEMAND,outFields:["*"]}),Ga=new s("https://zemelapiai.vplanas.lt/arcgis/rest/services/Interaktyvus_zemelapis/Mokyklos/MapServer",{id:"points-dyn"});Ga.suspend(),setTimeout(function(){var a=document.createElement("p");a.innerHtml="<p class='build-p'>Mokyklų paieška:</p>";document.getElementById("dijit_layout_TabContainer_1")},1600);var Ha=new F({name:"selectGraph",options:[{label:"Visos k.",value:[0],selected:!0},{label:"Lietuvių k.",value:[1]},{label:"Rusų k.",value:[2,5]},{label:"Lenkų k.",value:[3,4]}]},"language-filter");Ha.startup();var Ia=new F({name:"selectGraph",options:[{label:"Visos kl.",value:"none",selected:!0},{label:"1 klasė",value:1},{label:"2 klasė",value:2},{label:"3 klasė",value:3},{label:"4 klasė",value:4},{label:"5 klasė",value:5},{label:"6 klasė",value:6},{label:"7 klasė",value:7},{label:"8 klasė",value:8},{label:"9 klasė",value:9},{label:"10 klasė",value:10},{label:"11 klasė",value:11},{label:"12 klasė",value:12}]},"year-filter");Ia.startup();var Ja=new i({expanded:!0,sources:[{locator:new j("https://gis.vplanas.lt/arcgis/rest/services/Lokatoriai/ADRESAI_V1/GeocodeServer"),singleLineFieldName:"Single Line Input",outFields:["*"],enableSuggestions:!0,name:"Paieška",enableHighlight:!0,enableLabel:!1,localSearchOptions:{minScale:3e5,distance:5e4},placeholder:"Adresas, pvz.: Konstitucijos pr. 3",highlightSymbol:new k("/maps_vilnius/img/map_marker.png",36,36).setOffset(0,12)}],map:a},"search-schools");Ja.startup(),b.widgets.Search.main.emptyValue="Įveskite savo adresą",p(Ha,"change",ga),p(Ia,"change",ga);var Ka=new J("https://zemelapiai.vplanas.lt/arcgis/rest/services/Interaktyvus_zemelapis/Mokyklos/MapServer/1"),La=new I;La.outSpatialReference={wkid:3346},La.returnGeometry=!1,La.outFields=["*"],Ja.zoomScale=null,setTimeout(function(){var a=document.getElementsByTagName("form"),b=a[1].getElementsByTagName("input");b[0].name="search-schools_input"},400),p(Ja,"select-result",function(b){P.byId("schools-info").innerHTML="",P.byId("schools-filtered-list").innerHTML="",R.remove("schools-list","active");var c=a.getLayer("Points selection"),d=a.getLayer("Feature points selection");c&&(a.removeLayer(c),c={}),d&&(a.removeLayer(d),d={}),va=b.result.name,wa=b.result.feature.geometry,ka(b),Ja.searchResults[0].length>1?setTimeout(function(){f.hide()},4e3):f.hide()}),p(Ja,"search-results",function(a){ja(),P.byId("schools-info").innerHTML="",P.byId("schools-filtered-list").innerHTML=""}),p(Ja,"clear-search",function(){ja(),P.byId("schools-info").innerHTML="",R.remove("schools-list","active"),Fa.setOpacity(1);var b=a.getLayer("Mokyklos");b&&a.removeLayer(b);var c=a.getLayer("Points selection"),d=a.getLayer("Feature points selection");c&&(a.removeLayer(c),c={}),d&&(a.removeLayer(d),d={})}),p(a.infoWindow,"hide",ja);new S(S.STYLE_SOLID,new X(X.STYLE_SOLID,new N([193,39,45,1]),3),new N([129,183,206,1])),new S(S.STYLE_SOLID,new X(X.STYLE_SOLID,new N([78,78,78,0]),1),new N([195,219,159,0]));a.addLayers([Fa,Ga]),d([Fa],u),p(Fa,"click",function(a){sa(a)}),a.on("layers-add-result",function(b){var c=function(c,d){var e=u.map(c.layerInfos,function(a,b){var c;return b!==d?void a.defaultVisibility:(c=new H({"class":"layers-labels",checked:a.defaultVisibility?"checked=checked":"",id:a.id.toString()}),a.defaultVisibility&&ua.push(a.id),inputsList=c.domNode,label=Q.toDom("<label for='"+a.id+"'>"+a.name+"</label>"),inputsList.appendChild(label),tmp=document.createElement("div"),tmp.appendChild(inputsList),tmp.innerHTML)}),f=P.byId("layer-list");f.innerHTML=e.join(" "),Ga.setVisibleLayers(ua),p(f,"click",ta);var g=[];u.map(b.layers,function(a,b){"points-dyn"===a.layer.id&&g.push({layer:a.layer,title:"Įjungti sluoksniai"})}),legendDijit=new t({map:a,layerInfos:g},"legend-list"),legendDijit.startup()};c(Ga,0),e.onChange=function(a){Fa.setOpacity(a/100)},Fa.setOpacity(e.value/100)}),ra(Fa)})};