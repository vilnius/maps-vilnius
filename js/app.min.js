var MAPCONFIG={mapSettings:{},themes:{buildings:{custom:!0,name:"Pastatai ir statyba",id:"theme-buildings",imgUrl:"/maps_vilnius/img/statyba.png",imgAlt:"Pastatai ir statyba",layers:{administravimas:{dynimacLayerUrls:"http://zemelapiai.vplanas.lt/arcgis/rest/services/TESTAVIMAI/Demo/MapServer",featureLayerUrls:["http://zemelapiai.vplanas.lt/arcgis/rest/services/TESTAVIMAI/Pastatu_administravimas_test/MapServer/1"]}}},advertise:{custom:!0,name:"Leidimai",id:"ad",imgUrl:"/maps_vilnius/img/laisvalaikis.png",imgAlt:"Reklamos vietos"},transport:{name:"Transportas",id:"transport",imgUrl:"/maps_vilnius/img/transportas.png",imgAlt:"Transportas",layers:{dviraciuTrasos:{dynimacLayerUrls:"http://zemelapiai.vplanas.lt/arcgis/rest/services/Aplinkosauga/dviraciai_sisp_dynamic/MapServer"},gatviuTvarkymas:{dynimacLayerUrls:"http://195.182.69.66/ArcGIS/rest/services/Interaktyviam_zemelapiui/Grinda_gatviu_tvarkymas2/MapServer"}}},teritory:{name:"Teritorijų planavimas",id:"teritory-planning",imgUrl:"/maps_vilnius/img/statyba.png",imgAlt:"Teritorijų planavimas",layers:{laisviZemesPlotai:{dynimacLayerUrls:"http://zemelapiai.vplanas.lt/arcgis/rest/services/Interaktyvus_zemelapis/Laisvi_zemes_plotai/MapServer"},suprojektuotiStatiniai:{dynimacLayerUrls:"http://195.182.69.66/ArcGIS/rest/services/Projektuojami/proj_stat1/MapServer"}}},legacyMap:{custom:!0,name:"Senoji žemėlapio versija",id:"legacy",imgUrl:"/maps_vilnius/img/old_version.png",imgAlt:"Senoji versija",url:"http://www.vilnius.lt/vmap/t1.php"},demo:{name:"Demo versija",id:"demo",imgUrl:"/maps_vilnius/img/laisvalaikis.png ",imgAlt:"demo versija",layers:{demoLayer:{dynimacLayerUrls:"http://zemelapiai.vplanas.lt/arcgis/rest/services/TESTAVIMAI/Demo/MapServer"},badministravimas:{dynimacLayerUrls:"http://zemelapiai.vplanas.lt/arcgis/rest/services/Interaktyvus_zemelapis/Reklamos_registro_leidimai/MapServer"},bp:{dynimacLayerUrls:"http://zemelapiai.vplanas.lt/arcgis/rest/services/Teritorijos/VBP_LGII/MapServer"}}},bpDemo:{name:"BP demo",id:"bp",imgUrl:"/maps_vilnius/img/laisvalaikis.png ",imgAlt:"bp demo versija",layers:{bp:{dynimacLayerUrls:"http://zemelapiai.vplanas.lt/arcgis/rest/services/Teritorijos/VBP_LGII/MapServer"}}}},mapExtent:{xmin:555444.210800001,ymin:6051736.22,xmax:606967.016199999,ymax:6076388.28,spatialReference:{wkid:3346}},staticServices:{basemapUrl:"http://zemelapiai.vplanas.lt/arcgis/rest/services/Baziniai_zemelapiai/Vilnius_basemap_1000/MapServer",ortofotoUrl:"http://zemelapiai.vplanas.lt/arcgis/rest/services/Baziniai_zemelapiai/ORT5LT_2013/MapServer",geometryUrl:"http://zemelapiai.vplanas.lt/arcgis/rest/services/Utilities/Geometry/GeometryServer"},themesServices:{buildingTheme:{featureLayerBuildings:"http://zemelapiai.vplanas.lt/arcgis/rest/services/TESTAVIMAI/Pastatu_administravimas_test/MapServer/1",dynamicLayerBuildings:"http://zemelapiai.vplanas.lt/arcgis/rest/services/TESTAVIMAI/Pastatu_administravimas_test/MapServer"},dynamicLayerAdverts:"http://zemelapiai.vplanas.lt/arcgis/rest/services/Interaktyvus_zemelapis/Reklamos_registro_leidimai/MapServer",featureLayerAdverts:"http://zemelapiai.vplanas.lt/arcgis/rest/services/Interaktyvus_zemelapis/Reklamos_registro_leidimai/MapServer/0"}};Array.prototype.getUnique=function(){var a={},b=[],c=0,d=this.length;for(d;c<d;c+=1)a.hasOwnProperty(this[c]),b.push(this[c]),a[this[c]]=1;return b},window.location.hash="#",require(["esri/map","dojo/_base/connect","esri/toolbars/navigation","esri/config","dojo/on","dojo/query","esri/layers/ArcGISTiledMapServiceLayer","esri/layers/ArcGISDynamicMapServiceLayer","esri/dijit/Legend","dojo/_base/array","dojo/parser","esri/dijit/Popup","esri/dijit/PopupTemplate","esri/InfoTemplate","esri/layers/FeatureLayer","dojo/_base/declare","dojo/promise/all","dojo/Deferred","dgrid/OnDemandGrid","dgrid/Selection","dojo/store/Memory","dijit/form/CheckBox","dijit/registry","esri/tasks/query","esri/tasks/QueryTask","esri/request","dojo/dom","dojo/dom-construct","dojo/dom-class","esri/renderers/ClassBreaksRenderer","esri/symbols/PictureMarkerSymbol","esri/dijit/Measurement","esri/units","esri/dijit/Search","esri/tasks/locator","esri/symbols/SimpleFillSymbol","esri/symbols/SimpleMarkerSymbol","esri/renderers/SimpleRenderer","esri/symbols/SimpleLineSymbol","esri/Color","esri/geometry/Extent","app/clusterfeaturelayer","esri/graphic","esri/graphicsUtils","dojo/dom-style","dojo/_base/fx","dojo/fx/easing","esri/dijit/Scalebar","esri/layers/LayerInfo","esri/tasks/IdentifyTask","esri/tasks/IdentifyParameters","dijit/layout/TabContainer","dijit/layout/BorderContainer","dijit/layout/ContentPane","dojo/domReady!"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M,N,O,P,Q,R,S,T,U,V,W,X,Y){function Z(){var a=document.getElementById("map").offsetHeight/2,b=document.getElementById("map").offsetWidth/2,c=new esri.geometry.ScreenPoint(b,a,ma.spatialReference),d=ma.toMap(c);setTimeout(function(){ma.centerAt(d)},50)}function $(){return ma.extent.getWidth()/ma.width}function _(){var a=f(".dijitCheckBoxInput"),b=[];j.forEach(a,function(c){c.checked&&(b.push(c.id),b.push(0)),a[0].checked?(xa.show(),Aa.show(),ya.show(),"ad"===ga.currentTheme()&&Ga.show()):(xa.hide(),Aa.hide(),ya.hide(),"ad"===ga.currentTheme()&&Ga.hide())}),0===b.length&&b.push(-1),za.setVisibleLayers(b);var c="ad"===ga.currentTheme()?{layer:Aa}:{layer:za};legendDijit.refresh([c])}function aa(a){window.location.hash===a.currentTarget.getAttribute("href")&&(window.location.hash="#closed",a.preventDefault(),Da.deactivate())}var ba,ca,da=[],ea={},fa={extent:new esri.geometry.Extent(MAPCONFIG.mapExtent),popupProperties:{fillSymbol:new J(J.STYLE_SOLID,new M(M.STYLE_SOLID,new N([193,39,45,1]),3),new N([129,183,206,0])),titleInBody:!1},popupDom:B.create("div",{id:"ad-popup"}),popup:function(){var a=this;return new l(a.popupProperties,a.popupDom)}},ga={_getUrlQueryName:function(a,b){b||(b=window.location.href),b=b.toLowerCase(),a=a.replace(/[\[\]]/g,"\\$&").toLowerCase();var c=new RegExp("[?&]"+a+"(=([^&#]*)|&|#|$)"),d=c.exec(b);return d?d[2]?decodeURIComponent(d[2].replace(/\+/g," ")):"":null},mapInit:function(){return new a("map",{extent:fa.extent,logo:!1,showAttribution:!1,zoom:5,infoWindow:fa.popup(),nav:!1})},currentTheme:function(){return this._getUrlQueryName("theme")},currenthemeLabel:function(){for(var a=this.currentTheme(),b=document.getElementById("theme"),c=b.getElementsByTagName("div"),d=0;d<c.length;d++)c[d].id===a?c[d].className+=" current-theme":(c[d].className=c[d].className.replace(/(?:^|\s)current-theme(?!\S)/g,""),a||(document.getElementById("theme-buildings").className+=" current-theme"))},showCursor:function(a,b){b.forEach(a,function(a,b){a.on("mouse-over",function(){ma.setMapCursor("pointer")}),a.on("mouse-out",function(){ma.setMapCursor("default")})})},createThemeDom:function(){var a=MAPCONFIG.themes,b=1;for(var c in a)if(a.hasOwnProperty(c)){var d,e,f,g,h,i;if(d=e=f=g=h=i=null,a.hasOwnProperty(c)){b++;var j;j=h=b%2>0?"align-right":"align-left",d=B.create("div",{id:a[c].id,"class":"sub-theme "+h,style:""},"theme","last"),i=a[c].url?a[c].url:"./?theme="+a[c].id,e=B.create("a",{href:i},d),g=B.create("img",{src:a[c].imgUrl,alt:a[c].imgAlt},e),f=B.create("p",{innerHTML:a[c].name},d)}}},initTheme:function(){var a,b=MAPCONFIG.themes,c=this.currentTheme(),d=function(){setTimeout(function(){h.showLegendInput(a)},500)};for(var e in b)if(b.hasOwnProperty(e)){var f=b[e].id,g=b[e].custom;if(f===c&&!g){var h=this;a=this.createDynicLayers(b[e],e);for(var i in a)a.hasOwnProperty(i)&&ma.addLayer(a[i]);d()}}return a},reorderLayers:function(){j.forEach(ma.layerIds,function(a,b){b>1&&ma.reorderLayer("dyn-demo-bp",2)})},createDynicLayers:function(a,b){var c={},d=a.layers;for(var e in d)"undefined"!=typeof e&&(c["dyn"+b+e]=new h(d[e].dynimacLayerUrls,{id:"dyn-"+b+"-"+e}),c["dyn"+b+e].configLayerName=e);return c},setOpacity:function(a){for(var b in a)a.hasOwnProperty(b)&&a[b].setOpacity(value/100)},createLayerInfosArr:function(a){var b=[];for(var c in a)a.hasOwnProperty(c)&&(a[c].layerInfos.nameGroup=c,b.push(a[c].layerInfos));return this.createLayerInfosWithGroupName(b)},createLayerInfosWithGroupName:function(a){for(var b=0;b<a.length;b++)a[b]=this.createGroupName(a[b],a[b].nameGroup);return this.createLayerInfosResultArr(a)},createLayerInfosResultArr:function(a){var b;return b=[].concat.apply([],a)},createGroupName:function(a,b){for(var c=0;c<a.length;c++)a[c].groupName=b;return a},showLegendInput:function(a){var b=this.createLayerInfosArr(a),c=j.map(b,function(a,b){var c=new v({"class":"layers-labels",tabindex:a.id.toString(),value:a.groupName,checked:!!a.defaultVisibility,id:b.toString()});a.defaultVisibility&&da.push(a.id);var d=c.domNode,e=B.toDom("<label for='"+b+"'>"+a.name+"</label>");d.appendChild(e);var f=document.createElement("div");return f.appendChild(d),f.innerHTML}),d=A.byId("layer-list");d.innerHTML=c.join(" ");for(var f in a)a.hasOwnProperty(f)&&a[f].setVisibleLayers(a[f]._defaultVisibleLayers);var g=this.setupDefaultLegendLayers(a);if(g.length>0){var h=new i({map:ma,layerInfos:g},"legend-list");h.startup()}var k=this;e(d,"click",function(b){k.updateLayerVisibility(a,b,h,g)}),this.initIdentify(g)},setupDefaultLegendLayers:function(a){var b=[];for(var c in a)a.hasOwnProperty(c)&&b.push({layer:a[c],title:" "});return b.reverse()},updateLayerVisibility:function(a,b,c,d){var e=f(".layers-labels input");inputValues=[],visibleLayers={},j.forEach(e,function(a){a.checked&&(da.push(a.id),inputValues.push(a.value),visibleLayers.hasOwnProperty(a.value)?visibleLayers[a.value].push(a.tabIndex):(visibleLayers[a.value]=[a.tabIndex],ea[a.value]=["-1"]))});for(var g in visibleLayers)visibleLayers.hasOwnProperty(g)&&0===visibleLayers[g].length&&visibleLayers[g].push(-1);b&&this.showHideLayers(a,this.cloneVisibleLayer(visibleLayers,ea,b),b),c.refresh(d),this.initIdentify(d)},cloneVisibleLayer:function(a,b,c){for(var d in b)if(b.hasOwnProperty(d))for(var e in a)a.hasOwnProperty(e)&&d===e?d==c.toElement.value&&(b[e]=a[e]):d===c.toElement.value&&(b[e]=["-1"]);return b},showHideLayers:function(a,b,c){for(var d in a)a.hasOwnProperty(d)&&a[d].layerInfos.nameGroup===c.toElement.value&&this.getCurrentInput(c,a[d],b)},getCurrentInput:function(a,b,c){c.hasOwnProperty(a.toElement.value)&&b.setVisibleLayers(c[a.toElement.value])},initIdentify:function(a){ba=this.getParameters(a),ma.on("click",this.executeIdentify)},getParameters:function(a){var b,c={};for(var d in a)"getUnique"!==d&&(ca=new X(a[d].layer.url),b=new Y,b.tolerance=3,b.returnGeometry=!0,b.layerIds=this.getVisibleLayerIds(a[d].layer.visibleLayers),b.layerOption=Y.LAYER_OPTION_VISIBLE,b.width=ma.width,b.height=ma.height,c[a[d].layer.configLayerName]=b,c[a[d].layer.configLayerName].identifyTask=ca);return c},getVisibleLayerIds:function(a){var b=[];return j.map(a,function(a,c){b.push(a)}),b},executeIdentify:function(a){if(!Da.activeTool){var b=[],c=function(){return ba[d].identifyTask.execute(ba[d]).addCallback(function(a){return j.map(a,function(b){defResponse=a;var c=b.feature,d=" ",e=b.layerName,f=c.attributes;c.attributes.layerName=e;for(var g in f)f.hasOwnProperty(g)&&"OBJECTID"!=g&&"layerName"!=g&&(d+="<p class='bord'>"+f[g]+"</br><span>"+g+"</span><p>");var h=new n("<p>${layerName}</p>",d);return c.setInfoTemplate(h),C.add("ad-popup","default-popup"),c})})};for(var d in ba)if(ba.hasOwnProperty(d)){ba[d].geometry=a.mapPoint,ba[d].mapExtent=ma.extent;var e=c();b.push(e)}q(b).then(function(c){var d=[].concat.apply([],c);d.length>0&&(ma.infoWindow.setFeatures([].concat.apply([],b)),ma.infoWindow.show(a.mapPoint),C.add("ad-popup","animate"))})}},setDefaultSelectionSymbol:function(a){var b=new J(J.STYLE_SOLID,new M(M.STYLE_SOLID,new N([193,39,45,1]),3),new N([129,183,206,0]));a.setSymbol(b),ma.graphics.add(a)}};ga.createThemeDom(),k.parse(),ga.currenthemeLabel();var ha=A.byId("loading-gif"),ia=new esri.geometry.Extent(MAPCONFIG.mapExtent),ja={fillSymbol:new J(J.STYLE_SOLID,new M(M.STYLE_SOLID,new N([193,39,45,1]),3),new N([129,183,206,0])),titleInBody:!1},ka=B.create("div",{id:"ad-popup"});popup=new l(ja,ka);var la=new K("circle",24,new M(M.STYLE_LONGDASH,new N([223,52,59,0]),3),new N([255,255,255,0]));popup.markerSymbol=la;var ma=new a("map",{extent:ia,logo:!1,showAttribution:!1,zoom:0,infoWindow:popup,nav:!1}),na=(new c(ma),dojo.byId("zoomfullext"));e(na,"click",function(){var a=ia.getCenter();ma.centerAndZoom(a,0)}),ma.on("resize",function(){Z()});new V({map:ma,scalebarUnit:"metric"});d.defaults.io.proxyUrl="proxy/proxy.php",d.defaults.io.corsEnabledServers.push("http://zemelapiai.vplanas.lt");var oa=MAPCONFIG.staticServices.basemapUrl,pa=MAPCONFIG.staticServices.ortofotoUrl,qa=MAPCONFIG.themesServices.buildingTheme.featureLayerBuildings,ra=MAPCONFIG.themesServices.featureLayerAdverts,sa=MAPCONFIG.themesServices.buildingTheme.dynamicLayerBuildings,ta=MAPCONFIG.themesServices.dynamicLayerAdverts,ua=MAPCONFIG.staticServices.geometryUrl,va=(new n,new g(oa,{id:"topo"})),wa=new g(pa,{id:"orto"}),xa=new o(qa,{id:"buildings-feat",mode:o.MODE_ONDEMAND,maxAllowableOffset:$(),outFields:["*"]}),ya=new o(ra,{id:"adverts-feat",mode:o.MODE_ONDEMAND,outFields:["*"]}),za=new h(sa,{opacity:1,id:"buildings-dyn"}),Aa=new h(ta,{id:"adverts"});Aa.suspend();var Ba=[va,wa];ma.addLayers(Ba);var Ca=ga.initTheme();esri.config.defaults.geometryService=new esri.tasks.GeometryService(ua);var Da=new F({map:ma,defaultAreaUnit:G.HECTARES,defaultLengthUnit:G.KILOMETERS,deactivate:function(){var a=this.getTool();a&&(this.setTool(a.toolName,!1),this.clearResult())}},A.byId("tools-measure"));Da.startup();var Ea=document.getElementById("top-menu").getElementsByTagName("a");j.forEach(Ea,function(a){e(a,"click",function(){ma.infoWindow.hide(),Da.deactivate()})}),va.show(),wa.hide(),wa.hide();var Fa=document.getElementById("ortofoto");if(e(Fa,"click",function(){"none"===dojo.byId("zem").style.display?(dojo.byId("ort").style.display="none",dojo.byId("zem").style.display="block",wa.show(),va.hide()):(dojo.byId("ort").style.display="block",dojo.byId("zem").style.display="none",va.show(),wa.hide())}),"ad"===ga.currentTheme("theme")){var Ga=permitsTheme(ma);ma.on("layer-add-result",function(a){})}else"theme-buildings"!==ga.currentTheme()&&null!==ga.currentTheme()&&""!==ga.currentTheme()||buildingsTheme(ma,xa,Da,qa,ga.showCursor);ma.on("update-start",function(){esri.show(ha)}),ma.on("update-end",function(){esri.hide(ha)}),"ad"===ga.currentTheme()?ma.addLayers([Aa]):"theme-buildings"!==ga.currentTheme()&&null!==ga.currentTheme()&&""!==ga.currentTheme()||ma.addLayers([za]),require(["esri/dijit/HorizontalSlider"],function(a){var b=new a({labels:["0 %","100 %"],value:90,minimum:0,maximum:100,intermediateChanges:!0,discreteValues:100,showButtons:!1,onChange:function(a){if("ad"===ga.currentTheme())Ga.setOpacity(a/100);else if("theme-buildings"===ga.currentTheme()||null===ga.currentTheme()||""===ga.currentTheme())xa.setOpacity(a/100),za.setOpacity(a/100);else for(var b in Ca)Ca.hasOwnProperty(b)&&Ca[b].setOpacity(a/100)}},"tools-opacity-widget");if(b.startup(),Ca)for(var c in Ca)Ca.hasOwnProperty(c)&&Ca[c].setOpacity(b.value/100);"ad"===ga.currentTheme()||"theme-buildings"!==ga.currentTheme()&&null!==ga.currentTheme()&&""!==ga.currentTheme()||za.setOpacity(b.value/100)}),e(ma,"onZoomEnd",function(){maxOffset=$(),layer.setMaxAllowableOffset(maxOffset)}),ma.infoWindow.resize(350,400);var Ha=new H({sources:[{locator:new I("http://zemelapiai.vplanas.lt/arcgis/rest/services/Lokatoriai/PAIESKA_COMPOSITE/GeocodeServer"),singleLineFieldName:"SingleLine",enableSuggestions:!0,name:"Paieška",enableHighlight:!0,enableLabel:!1,localSearchOptions:{minScale:3e5,distance:5e4},placeholder:"Paieška",highlightSymbol:new E("/maps_vilnius/img/map_marker.png",36,36).setOffset(0,12)}],map:ma},"search");Ha.startup(),ma.on("layers-add-result",function(a){if("ad"===ga.currentTheme()||"theme-buildings"===ga.currentTheme()||null===ga.currentTheme()||""===ga.currentTheme()){var b=function(b,c){var d=j.map(b.layerInfos,function(a,b){var d;return b!==c?void(a.defaultVisibility&&da.push(a.id)):(d=new v({"class":"layers-labels",checked:a.defaultVisibility?"checked=checked":"",id:a.id.toString()}),a.defaultVisibility&&da.push(a.id),inputsList=d.domNode,label=B.toDom("<label for='"+a.id+"'>"+a.name+"</label>"),inputsList.appendChild(label),tmp=document.createElement("div"),tmp.appendChild(inputsList),tmp.innerHTML)}),f=A.byId("layer-list");f.innerHTML=d.join(" "),za.setVisibleLayers(da),e(f,"click",_);var g=j.map(a.layers,function(a,b){return{layer:a.layer,title:"Įjungti sluoksniai"}});g.length<2&&(legendDijit=new i({map:ma,layerInfos:g},"legend-list"),legendDijit.startup())};"ad"===ga.currentTheme()?b(Aa,0):"theme-buildings"!==ga.currentTheme()&&null!==ga.currentTheme()&&""!==ga.currentTheme()||b(za,1)}});for(var Ia=document.getElementsByTagName("a"),Ja=0;Ja<Ia.length;Ja++)Ia[Ja].addEventListener("click",aa,!1);var Ka=new Date,La=Ka.getFullYear();document.getElementById("credits").innerHTML=La+" m. | VMS interaktyvūs žemėlapiai | <a href='http://www.vilniausplanas.lt/' target='_blank'>SĮ „Vilniaus planas“</a>";var Ma=[xa,ya];ga.showCursor(Ma,j)});var permitsTheme=function(a){var b;return require(["dojo/on","esri/dijit/Popup","esri/dijit/PopupTemplate","esri/InfoTemplate","dojo/promise/all","dojo/Deferred","esri/tasks/query","esri/tasks/QueryTask","esri/symbols/SimpleMarkerSymbol","esri/renderers/SimpleRenderer","esri/Color","esri/request","dojo/dom","dojo/dom-construct","dojo/dom-class","esri/renderers/ClassBreaksRenderer","esri/symbols/SimpleFillSymbol","esri/symbols/SimpleMarkerSymbol","esri/renderers/SimpleRenderer","esri/symbols/SimpleLineSymbol","esri/Color","esri/geometry/Extent","app/clusterfeaturelayer","esri/graphic","esri/graphicsUtils","dojo/dom-style","dojo/_base/fx","dojo/fx/easing","esri/layers/LayerInfo"],function(c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,k,l,t,m,u,v,w,x,y,z,A,B){function C(a){var b="",c=a.length;if(c>1)for(var d=0;d<c;d++){var e="<p></i><a href='"+a[d].url+"' target='blank'>"+a[d].icon+"</a></p>";b+=e}else if("Dokumentų nėra"===a[0]){var e="<p><i class='fa fa-exclamation'></i><span>"+a[0]+"</span></p>";b+=e}return o.byId("ad-attachment").innerHTML=b,a}function D(){clearTimeout(X),X=setTimeout(function(){var b,c=a.infoWindow.selectedIndex;if(c!==-1){b=a.infoWindow.features[c],I(),a.infoWindow._lastSelected=new w(b.toJson()),a.infoWindow._lastSelected.setSymbol(P),a.graphics.add(a.infoWindow._lastSelected);var d=H(b);d.then(function(a){console.log("REDAS"),console.log(a)})}},50)}function E(a){var b=new h,c=new i;c.returnGeometry=!1,c.outFields=["ID","VLN_REKLAMOS_ID","CONTENTTYPE","TITLE "],c.where="VLN_REKLAMOS_ID = '"+a+"'";var d;return d=new j("http://zemelapiai.vplanas.lt/arcgis/rest/services/Interaktyvus_zemelapis/Reklamos_registro_leidimai/MapServer/1"),b.resolve({query:c,task:d}),b.promise}function F(a){Y=setTimeout(function(){Q.length=0,window.clearTimeout(Y),console.log("REZULATATAI"),console.log(a),console.log("END REZULATATAI");var b="http://www.vilnius.lt/isorei/isorinereklama/files/",c=a.features;if(0!=c.length)for(var d=0;d<c.length;d++){var e=a.features[d].attributes.CONTENTTYPE,f=parseInt(a.features[d].attributes.VLN_REKLAMOS_ID,10),g=a.features[d].attributes.TITLE,h=b+f+"_"+g,i={url:h,icon:G(e)};Q.push(i),runURL=function(a){C.call(null,Q)},setTimeout(function(){runURL(Q)},500)}else Q=["Dokumentų nėra"],runURL=function(a){C.call(null,Q)},setTimeout(function(){runURL(Q)},50);return Q},1e3)}function G(a){var b="",c=a.split("/"),d=c.length,e=c[d-1];switch(e){case"pdf":b="<i class='fa fa-file-pdf-o' aria-hidden='true'></i>";break;case"vnd.openxmlformats-officedocument.wordprocessingml.document":b="<i class='fa fa-file-word-o' aria-hidden='true'></i>";break;case"vnd.lt.archyvai.adoc-2008":b="<i class='fa fa-file-word-o' aria-hidden='true'></i>";break;case"vnd.ms-excel":b="<i class='fa fa-file-excel-o' aria-hidden='true'></i>";break;case"jpeg":b="<i class='fa fa-file-image-o' aria-hidden='true'></i>";break;default:b="<i class='fa fa-file-o' aria-hidden='true'></i>"}return b}function H(b){var c=new h,d=b.attributes.GALIOJA,e=b.attributes.ID;if(e&&d){var f=E(e);f.then(function(a){setTimeout(function(){a.task.execute(a.query,F),console.log("DEFAS"),console.log(a),c.resolve(a)},100)}),1===d||3===d?(a.infoWindow.setTitle("Galiojantis reklamos registro leidimas "),N.setTitle("Galiojantis reklamos registro leidimas "),q.contains("ad-popup","invalid-ad")?q.remove("ad-popup","invalid-ad"):q.add("ad-popup","valid-ad"),q.add("ad-popup","valid-ad")):2===d&&(a.infoWindow.setTitle("Negaliojantis reklamos registro leidimas "),N.setTitle("Negaliojantis reklamos registro leidimas "),q.contains("ad-popup","valid-ad")?q.remove("ad-popup","valid-ad"):q.add("ad-popup","invalid-ad"),q.add("ad-popup","invalid-ad")),console.log("features set"),console.log(b)}return c.promise}function I(){a.infoWindow._lastSelected&&(a.graphics.remove(a.infoWindow._lastSelected),a.infoWindow._lastSelected=null)}function J(a,b,c){var d;a&&(a.setAttribute("fill-opacity",b),a.setAttribute("stroke-opacity",c),d=a.nextElementSibling,d&&"text"===d.nodeName&&d.setAttribute("fill-opacity",1))}function K(){y.set(a.infoWindow.domNode,"opacity",0),z.fadeIn({node:a.infoWindow.domNode,duration:150,easing:A.quadIn}).play()}var L=o.byId("loading-gif");a.on("update-start",function(){esri.show(L)}),a.on("update-end",function(){esri.hide(L)}),a.on("click",function(a){});var M,N,O,P,Q=[];popup=a.infoWindow,popup.highlight=!1,popup.titleInBody=!1,N=new f,N.setContent("<ul><li>${DATA:DateFormat(selector: 'date', fullYear: true)}<br><span>Leidimo data</span></li><li>${GALIOJA_IKI:DateFormat(selector: 'date', fullYear: true)}<br><span>Galioja iki</span></li><li>${ADRESAS}<br><span>Adresas</span></li><li>${SENIUNIJA}<br><span>Seniūnija</span></li><li>${UZSAKOVAS}<br><span>Užsakovas</span></li><li>${UZSAKOVO_KODAS}<br><span>Užsakovo kodas</span></li></ul><p>Dokumentai atsisiųsti:</p><div id='ad-attachment'><p style='text-align: center;'><img src='http://vilniausplanas.lt/maps_vilnius/img/ajax-loader.gif' style=' width: 20px;    text-align: Center;    margin: 0 auto;'></p></div><p>${SHOWS}<br><span>Reg. nr.</span></p><p>${REKLAMOS_TIPAS}<br><span>Reklamos Tipas</span></p><p>${TURINYS}<br><span>Turinys</span></p><p>${REKLAMOS_PLOTAS}<br><span>Plotas m <sup>2</sup></span></p>"),P=new k("circle",24,new t(t.STYLE_LONGDASH,new m([223,52,59,1]),3),new m([255,255,255,0]));var R,S,T,U,V,W;R=new v({url:"http://zemelapiai.vplanas.lt/arcgis/rest/services/Interaktyvus_zemelapis/Reklamos_registro_leidimai/MapServer/0",distance:30,id:"clusters",labelColor:"#484848",resolution:a.extent.getWidth()/a.width,singleTemplate:N,useDefaultSymbol:!1,maxSingles:12e3,zoomOnClick:!0,showSingles:!0,outFields:["*"]}),S=new r(O,"clusterCount"),T=new k("circle",30,new t(t.STYLE_SOLID,new m([255,210,75,.4]),15),new m([255,210,75,.85])),U=new k("circle",40,new t(t.STYLE_SOLID,new m([255,210,75,.4]),15),new m([255,210,75,.85])),V=new k("circle",50,new t(t.STYLE_SOLID,new m([255,210,75,.4]),15),new m([255,210,75,.75])),W=new k("circle",60,new t(t.STYLE_SOLID,new m([255,210,75,.4]),15),new m([255,210,75,.85])),S.addBreak(2,50,T),S.addBreak(50,250,U),S.addBreak(250,1e3,V),S.addBreak(1e3,5e4,W),R.setRenderer(S),a.addLayer(R),c(R,"click",function(b){console.log(b),R.geometry=b.mapPoint,pxWidth=a.extent.getWidth()/a.width,padding=30*pxWidth,qGeom=new u({xmin:R.geometry.x-padding,ymin:R.geometry.y-padding,xmax:R.geometry.x+padding,ymax:R.geometry.y+padding,spatialReference:R.geometry.spatialReference}),R.geometry=qGeom,console.log("clusterLayer.geometry: "),console.log(R.geometry)});var X,Y;return a.infoWindow.on("selection-change",function(){D(),K()}),a.infoWindow.on("hide",function(){J(M,.75,.5),I()}),b=R}),b},buildingsTheme=function(a,b,c,d,e){require(["dojo/_base/connect","esri/toolbars/navigation","esri/config","dojo/on","dojo/query","esri/layers/ArcGISTiledMapServiceLayer","esri/layers/ArcGISDynamicMapServiceLayer","esri/dijit/Legend","dojo/_base/array","dojo/parser","esri/dijit/Popup","esri/dijit/PopupTemplate","esri/InfoTemplate","esri/layers/FeatureLayer","dojo/_base/declare","dojo/promise/all","dojo/Deferred","dgrid/OnDemandGrid","dgrid/Selection","dojo/store/Memory","dijit/form/CheckBox","esri/tasks/query","esri/tasks/QueryTask","esri/symbols/SimpleMarkerSymbol","esri/renderers/SimpleRenderer","esri/Color","esri/request","dojo/dom","dojo/dom-construct","dojo/dom-class","esri/symbols/SimpleFillSymbol","esri/renderers/ClassBreaksRenderer","esri/dijit/Measurement","esri/units","esri/dijit/Geocoder","esri/symbols/SimpleLineSymbol","esri/geometry/Extent","app/clusterfeaturelayer","esri/graphic","esri/graphicsUtils","dojo/dom-style","dojo/_base/fx","dojo/fx/easing","dijit/registry","esri/dijit/Scalebar","esri/layers/LayerInfo","dijit/layout/TabContainer","dijit/layout/BorderContainer","dijit/layout/ContentPane","dojo/domReady!"],function(f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M,N,O,P,Q,R,S,T,U,V,W,X,Y){function Z(d){dijit.byId("selection-list")&&dijit.byId("selection-list").destroy(),window.location.hash="#close";var e=a.getMaxZoom()-1;a.centerAndZoom(d.mapPoint,e),buildingAdministration.geometry=d.mapPoint,aa.execute(buildingAdministration,$).then(function(){_.createSelection()}),b.selectFeatures(buildingAdministration,b.SELECTION_NEW),setTimeout(function(){window.location.hash="#build-data",c.deactivate()},100)}function $(f){function g(){switch(N){case 1:P="Savivaldybės paskirtas administratorius";break;case 2:P="Bendrija";break;case 3:P="JVS";break;case 6:P="Bendrija (statybos)";break;case 8:P="Nenustatyta valdymo forma";break;case 9:P="Neprižiūrimi pastatai";break;default:P="Nėra duomenų"}return P}function h(){var b;a.on("mouse-over",function(c){require(["dijit/TooltipDialog","dijit/popup","dojo/on","dojo/dom","dojo/domReady!"],function(c,d,e,f){b=new c({id:"myTooltipDialogCompare",style:"width: 160px;",content:"<p>Pažymėkite kitą pastatą palyginimui</p>",onMouseLeave:function(){d.close(b)}}),b.startup(),a.on("mouse-move",function(a){d.open({popup:b,x:a.x+10,y:a.y+10})})})}),a.on("mouse-out",function(){b.destroy()})}function j(){function f(b){window.location.hash="#close";var d=a.getMaxZoom()-1;a.centerAndZoom(b.mapPoint,d),q.geometry=b.mapPoint,o.execute(q,g),k.selectFeatures(q,k.SELECTION_NEW),c.deactivate()}function g(a){var b=a.features[0].attributes;for(var c in b)if(b.hasOwnProperty(c)){b[c]||(b[c]="Nėra duomenų",Ea=b)}var d,e,f,g,h,i,j;j=b.NTRUNKNR,d=b.ADRESAS,admC=b.ADMTARIF,f=b.BENDR_PLOT,e=b.ADMINISTR,g=b.ATLKMAX,h=b.NTPTMAX,i=b.NSPTMAX,Qa="undefined"==typeof Qa?Qa="Nėra duomenų":Qa;var k=p(j);k.then(function(a){var b="<div id='build-inner-stat-adm' class='section group animate'> <div class='colu span_1_of_3'><p ></p></div><div class='colu span_1_of_3 first-build'> <p><span>JŪSŲ PASTATAS</span></p></div> <div class='colu span_1_of_3 second-build'> <p><span>PASTATAS PALYGINIMUI</span></p></div><div class='colu span_1_of_3'><p class='normalf'>Adresas: </p></div> <div class='colu span_1_of_3' style='background: #F7F7F7;'><p>"+w+"</p></div><div class='colu span_1_of_3' style='background: #F7F7F7;'> <p>"+d+"</p></div><div class='colu span_1_of_3'><p class='normalf'>Žymėjimas: </p></div> <div class='colu span_1_of_3' style='background: #F7F7F7;'><p><span class='box first'></span></p> </div> <div class='colu span_1_of_3' style='background: #F7F7F7;'> <p><span class='box second'></span></p></div><div class='colu span_1_of_3'><p class='normalf'>Valdytojas: </p></div> <div class='colu span_1_of_3 vald' style='background: #F7F7F7;'><p>"+x+"</p> </div> <div class='colu span_1_of_3 vald' style='background: #F7F7F7;'> <p>"+e+"</p></div><div class='colu span_1_of_3'><p class='normalf'>Bendras plotas <br><b> (m²)</b>: </p> </div> <div class='colu span_1_of_3' style='background: #F7F7F7;'><p>"+F+"</p> </div> <div class='colu span_1_of_3' style='background: #F7F7F7;'> <p>"+f+"</p></div><div class='colu span_1_of_3'> <p class='normalf'>Administracinis tarifas <br><b> (Eur/m²)</b>:</p> </div> <div class='colu span_1_of_3' style='background: #F7F7F7;'> <p>"+va+"</p> </div> <div class='colu span_1_of_3' style='background: #F7F7F7;'> <p>"+admC+"</p></div><div class='colu span_1_of_3'> <p class='normalf'>Atliekų tarifas <b> (Eur/m²)</b>:</p> </div> <div class='colu span_1_of_3' style='background: #F7F7F7;'> <p>"+(null===ea?"Nėra duomenų":ea)+"</p> </div><div class='colu span_1_of_3' style='background: #F7F7F7;'> <p>"+g+"</p> </div> <div class='colu span_1_of_3'> <p class='normalf'>Techninės priežiūros tarifas <b> (Eur/m²)</b>:</p></div><div class='colu span_1_of_3' style='background: #F7F7F7;'><p>"+(null===na?"Nėra duomenų":na)+"</p> </div> <div class='colu span_1_of_3' style='background: #F7F7F7;'> <p>"+h+"</p></div> <div class='colu span_1_of_3'> <p class='normalf'>Šildymo sistemų priežiūros tarifas <b> (Eur/m²)</b>: </p> </div><div class='colu span_1_of_3' style='background: #F7F7F7;'><p>"+(null===qa?"Nėra duomenų":qa)+"</p> </div> <div class='colu span_1_of_3' style='background: #F7F7F7;'> <p>"+i+"</p></div><div class='colu span_1_of_3'> <p class='normalf'>Šildymo s. vidutinė mėn. šildymo kaina <b> (Eur/m²)</b>: </p> </div> <div class='colu span_1_of_3' style='background: #F7F7F7;'> <p>"+Qa+"</p> </div> <div class='colu span_1_of_3' style='background: #F7F7F7;'> <p>"+a+"</p></div>";G.byId("build-inner-stat-table").innerHTML=b,window.location.hash="#build-statistics"})}I.add("myBarChart","hide"),I.remove("myBarChart","show"),I.add("bar-legend","hide"),I.remove("bar-legend","show"),Ra=!0,window.location.hash="#close",I.add("start-compare","hide"),I.remove("start-compare","show"),I.add("bar-tips","hide"),I.remove("bar-tips","show"),h();var j=G.byId("stats-close");j.addEventListener("click",function(){I.add("myBarChart","show"),I.remove("myBarChart","hide"),I.remove("start-compare","hide"),I.add("start-compare","show"),I.remove("bar-legend","hide"),I.add("bar-legend","show"),I.remove("bar-tips","hide"),I.add("bar-tips","show"),H.destroy("tooltip-span"),window.location.hash="#build-data",a.removeLayer(k),k={},G.byId("build-inner-stat-table").innerHTML="",b.enableMouseEvents()},!1),b.disableMouseEvents();var k=new s(d,{id:"buildings-compare",mode:s.MODE_ONDEMAND,outFields:["*"]}),l=new J(J.STYLE_SOLID,new O(O.STYLE_SOLID,new E([88,23,179,1]),3),new E([129,183,206,0]));k.setSelectionSymbol(l);var m=new J(J.STYLE_SOLID,new O(O.STYLE_SOLID,new E([78,78,78,0]),1),new E([195,219,159,0]));k.setRenderer(new D(m)),a.addLayer(k);var o=new B("http://zemelapiai.vplanas.lt/arcgis/rest/services/TESTAVIMAI/Pastatu_administravimas_test/MapServer/1"),q=new A;q.outSpatialReference={wkid:3346},q.returnGeometry=!1,q.outFields=["*"],e([k],n),i(k,"click",f)}function k(a,b){var c=new XMLHttpRequest;c.open("HEAD",a,!0),c.send(),c.onreadystatechange=function(){if(4===c.readyState)return 404===c.status?(Va+=1,console.log(Va),m(b,a),!1):(Ua+=1,l(b,a),!0)}}function l(a,b){var c=document.createElement("p"),d=document.getElementById("build-inner-d");switch(a){case"ilgalaikisPlanas":Wa.messagePlanas="<i class='fa fa-file-pdf-o'></i> <a href='"+b+"' target='_blank'>Ilgalaikis planas</a>",c.innerHTML=Wa.messagePlanas,d.appendChild(c);break;case"ukinisPlanas":Wa.messageUPlanas="<i class='fa fa-file-pdf-o'></i> <a href='"+b+"' target='_blank'>Ūkinis planas</a>",c.innerHTML=Wa.messageUPlanas,d.appendChild(c);break;case"metineVeiklosAtaskaita":Wa.messageAtaskaita="<i class='fa fa-file-pdf-o'></i> <a href='"+b+"' target='_blank'>"+t+" m. metinė veiklos ataskaita</a>",c.innerHTML=Wa.messageAtaskaita,d.appendChild(c)}}function m(a,b){var c=document.createElement("p"),d=document.getElementById("build-inner-d");switch(a){case"ilgalaikisPlanas":Wa.messagePlanas="<i class='fa fa-exclamation'></i>Nėra ilgalaikio plano duomenų",c.innerHTML=Wa.messagePlanas,d.appendChild(c);break;case"ukinisPlanas":Wa.messageUPlanas="<i class='fa fa-exclamation'></i>Nėra ūkinio plano duomenų",c.innerHTML=Wa.messageUPlanas,d.appendChild(c);break;
case"metineVeiklosAtaskaita":Wa.messageAtaskaita="<i class='fa fa-exclamation'></i>Nėra metinės veiklos ataskaitos duomenų",c.innerHTML=Wa.messageAtaskaita,d.appendChild(c)}}function o(a){var b=0,c=a.length,d=0;for(b;b<c;b+=1){if(a[b]&&"undefined"!=typeof a)return!0;d+=1}}function p(a){var b=new v;ca.where="NTRUNKNR = '"+a+"'",ca.returnGeometry=!1,ca.outFields=["*"];var c=ba.execute(ca);return c.then(function(a){var c=q(a);c.then(function(a){return b.resolve(a)})}),b.promise}function q(a){var b=new v,c=null;return setTimeout(function(){var d;if("undefined"==typeof a.features[0])eb=!1,c="Nėra duomenų",b.resolve(c);else{eb=!0;var e=a.features[0].attributes.METAIMAX,f=a.features,g=e,h=e-1,i=e-2,j=[],k={};k.einamiejiMetai=e;for(var l,m,n,o,p,q,s,t=0,u=f.length;t<u;t+=1){var v=a.features[t].attributes.SEZONAS;if(v===g||v===h||v===i)switch(j.push(v),l=a.features[t].attributes.SPAL_K,m=a.features[t].attributes.LAPKR_K,n=a.features[t].attributes.GRUOD_K,o=a.features[t].attributes.SAUS_K,p=a.features[t].attributes.VASAR_K,q=a.features[t].attributes.KOVAS_K,s=a.features[t].attributes.BALAN_K,v){case g:k.paskutiniaiMetai=[l,m,n,o,p,q,s];break;case h:k.viduriniaiMetai=[l,m,n,o,p,q,s];break;case i:k.galiniaiMetai=[l,m,n,o,p,q,s]}}var w=[k.paskutiniaiMetai,k.viduriniaiMetai,k.galiniaiMetai,k.einamiejiMetai];d=function(a){r.apply(null,a)},setTimeout(function(){d(w)},50),Ra?k.paskutiniaiMetai=c="undefined"==typeof k.paskutiniaiMetai?"Nėra duomenų":(k.paskutiniaiMetai.reduce(function(a,b){return a+b})/7).toFixed(3):(Qa=k.paskutiniaiMetai.reduce(function(a,b){return a+b}),Qa=(Qa/7).toFixed(3)),b.resolve(c)}},50),b.promise}function r(a,b,c,d){function e(){i(dojo.byId("build-temp-bt"),"click",function(){var a=document.getElementById("myChart-heating").getContext("2d");window.myLineHeating=new Chart(a).Line(j,k,{responsive:!1});var b=myLineHeating.generateLegend();G.byId("chart-legend-heating").innerHTML="<p><b>ŠILUMOS GRAFIKAS:</b></p><p>Vidutinė mėnesinė šildymo kaina EUR/m²</p>"+b})}var f=d+1,g=d,h=d-1,j={labels:["Spalis","Lapkritis","Gruodis","Sausis","Vasaris","Kovas","Balandis"],datasets:[{label:g+"-"+f+" m. vidutinė šildymo kaina  EUR/m²",fillColor:"rgba(151, 187, 205, 0.6)",strokeColor:"rgba(151, 187, 205, 1)",pointColor:"rgba(151, 187, 205, 1)",pointStrokeColor:"#fff",pointHighlightFill:"#fff",pointHighlightStroke:"rgba(151,187,205,1)",data:a},{label:h+"-"+g+" m. vidutinė šildymo kaina EUR/m²",fillColor:"rgba(154, 195, 146, 0.6)",strokeColor:"rgba(154, 195, 146, 1)",pointColor:"rgba(154, 195, 146, 1)",pointStrokeColor:"#fff",pointHighlightFill:"#fff",pointHighlightStroke:"rgba(220, 220, 220, 1)",data:b},{label:h-1+"-"+h+" m. vidutinė šildymo kaina EUR/m²",fillColor:"rgba(222, 135, 71, 0.6)",strokeColor:"rgba(222, 135, 71, 1)",pointColor:"rgba(222, 135, 71, 1)",pointStrokeColor:"#fff",pointHighlightFill:"#fff",pointHighlightStroke:"rgba(222, 135, 71, 1)",data:c}]},k={scaleShowGridLines:!0,scaleShowLabels:!0,scaleGridLineColor:"rgba(0,0,0,.05)",scaleGridLineWidth:1,scaleShowHorizontalLines:!0,scaleShowVerticalLines:!0,bezierCurve:!0,bezierCurveTension:.4,pointDot:!0,pointDotRadius:6,pointDotStrokeWidth:1,pointHitDetectionRadius:20,datasetStroke:!0,datasetStrokeWidth:2,datasetFill:!1,tooltipCornerRadius:2,multiTooltipTemplate:"<%= value %> Eur/m² ",legendTemplate:'<div class="<%=name.toLowerCase()%>-legend"><% for (var i=0; i<datasets.length; i += 1){%><p><span style="background-color:<%=datasets[i].fillColor%>"></span><%if(datasets[i].label){%><%=datasets[i].label%><%}%></p><%}%></div>'};e()}"undefined"!=typeof myLine&&myLine.destroy(),"undefined"!=typeof myLineHeating&&myLineHeating.destroy();var t,u,w,x,y,z,C,F,K,L,M,N,P,Q,R,S,T,U,V,W,X,Y,Z,$,aa,da,ea,fa,ga,ha,ia,ja,ka,la,ma,na,oa,pa,qa,ra,sa,ta,ua,va,wa,xa,ya,za,Aa,Ba,Ca,Da=f.features[0].attributes,Ea={};for(var Fa in Da)if(Da.hasOwnProperty(Fa)){Da[Fa]||("ATLKMAX"==Fa||"ATLKMID"==Fa||"ATLKMIN"==Fa||"LTPTMAX"==Fa||"LTPTMID"==Fa||"LTPTMIN"==Fa||"NTPTMAX"==Fa||"NTPTMID"==Fa||"NTPTMIN"==Fa||"KITMAX"==Fa||"KITMID"==Fa||"KITMIN"==Fa||"LKITMAX"==Fa||"LKITMID"==Fa||"LKITMIN"==Fa||"NSPTMAX"==Fa||"NSPTMID"==Fa||"NSPTMIN"==Fa?Ea=Da:(Da[Fa]="Nėra duomenų",Ea=Da))}t=Da.METAIMAX,u="Nėra duomenų"==Da.A_ADMINIKI?"Nėra duomenų":Da.A_ADMINIKI_T,w=Da.ADRESAS,y="Nėra duomenų"==Da.STATMET?"Nėra duomenų":Da.STATMET+" metai",z=Da.STATPASK,C=Da.NR_PLANE,F=Da.BENDR_PLOT,L=Da.NAUD_PLOT,K=Da.PATALPUGSK,M="Nėra duomenų"==Da.PATALPUNSK?"Nėra":Da.PATALPUNSK,va="Nėra duomenų"==Da.ADMTARIF?"Nėra duomenų":Da.ADMTARIF,wa="Nėra duomenų"==Da.SKL_PLOT?"Nėra duomenų":Da.SKL_PLOT+" a",xa=Da.SAV_TEISES,ya=Da.NTRUNKNR,za=ya.toString().substr(0,4)+"-"+ya.toString().substr(4,4)+"-"+ya.toString().substr(8),x=Da.ADMINISTR,N=Da.VALDFORM,P=g(),Q=Da.A_ADRES,R=Da.A_PASKPAGR,S=Da.A_VADOVAS,T=Da.A_VADTEL,U=Da.NPVADYB,V=Da.A_VADYBTEL,W=Da.A_ELPAST,X=Da.A_KODAS,Y="Nėra duomenų"==Da.SKUNDUSK?"Nėra duomenų":Da.SKUNDUSK+" vnt.",Z=Da.SKUNDPOB,$="Nėra duomenų"==Da.ENEFKL?"Nėra duomenų":Da.ENEFKL+" klasė",aa="Nėra duomenų"==Da.RENOVMET?"Nėra duomenų":Da.RENOVMET+" metai",da=Da.RENOVUOTA,ea=Da.ATLKMAX,fa=Da.ATLKMID,ga=Da.ATLKMIN,ha=Da.LTPTMAX,ia=Da.LTPTMAX,ja=Da.LTPTMID,ka=Da.LTPTMIN,na=Da.NTPTMAX,ma=Da.NTPTMID,la=Da.NTPTMIN,qa=Da.NSPTMAX,pa=Da.NSPTMID,oa=Da.NSPTMIN,ua="Nėra duomenų"==Da.SUKAUPTA?"Nėra duomenų":Da.SUKAUPTA+" Eur",ta=Da.KITMAX,sa=Da.KITMID,ra=Da.KITMIN,kaupTar=null===ta?"Nėra duomenų":ta+" Eur/m²",Aa=Da.NTPRIZ,Ba=Da.NSPRIZ,Ca=Da.LTPRIZ;var Ga=[ga,fa,ea],Ha=[ka,ja,ia],Ia=[la,ma,na],Ja=[oa,pa,qa],Ka="<h3>"+w+"</h3><p>"+za+"<br><span>Unikalus numeris</span></p><p>"+y+"<br><span>Statybos metai</span></p><p>"+C+"<br><span>Korpusas</span></p><p>"+z+"<br><span>Namo paskirtis</span></p><p class='build-bt build-top'><a href='#build-info' class='animate'>Bendroji informacija</a></p><p class='build-bt'><a href='#build-manage' class='animate'>Valdytojų informacija</a></p><p class='build-bt'><a href='#build-temp' id='build-temp-bt' class='animate'>Šildymo duomenys / Renovacija</a></p><p class='build-bt'><a href='#build-maintenance' class='animate'>Namo priežiūros tarifai</a></p><p class='build-bt'><a href='#build-docs' class='animate'>Ataskaitos ir planai</a></p><p class='build-bt'><a href='#build-statistics' class='animate'>Tarifų palyginimas</a></p><p class='build-bt'><a href='#build-help' class='animate'>Pagalba ir duomenų suvedimas</a></p><p class='build-bt'><a href='#build-imp-info' class='animate'>Svarbi informacija</a></p>";G.byId("build-inner").innerHTML=Ka;var La="<h3>"+w+"</h3><p>"+F+" m²<br><span>Bendras plotas</span></p><p>"+L+" m²<br><span>Naudingasis plotas</span></p><p>"+K+"<br><span>Gyvenamų patalpų skaičius</span></p><p>"+M+"<br><span>Negyvenamų patalpų skaičius</span></p><p>"+wa+"<br><span>Sklypo plotas arais</span></p><p>"+xa+"<br><span>Namui priskirto žemės sklypo patalpų savivinkų teisės</span></p>";G.byId("build-inner-i").innerHTML=La;var Ma="<h3>"+w+"<br></h3><p>"+P+" <br><span>Valdymo forma</span></p><p>"+x+" <br><span>administratorius</span></p><p>"+u+" <br><span>administratoriaus paskyrimo terminas</span></p><p>"+Q+"<br><span><span class='bnov'>BNOV (Bendrojo naudojimo objektų valdytojas)</span> adresas</span></p><p>"+R+"<br><span> Vilniaus miesto savivaldybės administracijos įsakymas</span></p><p>"+S+"<br><span><span class='bnov'>BNOV</span> vadovas</span></p><p>"+T+"<br><span><span class='bnov'>BNOV</span> vadovo telefonas</span></p><p>"+U+"<br><span>Namo priežiūros vadybininkas:</span></p><p style='display:none;'>"+V+"<br><span>Namo priežiūros vadybininko telefonas</span></p><p>"+Y+"<br><span><span class='bnov'>BNOV</span> gaunamų skundų skaičius</span></p><p>"+Z+"<br><span><span class='bnov'>BNOV</span> gaunamų skundų pobūdis</span></p><p>"+X+" <br><span><span class='bnov'>BNOV</span> kodas</span></p><p><a href='mailto:"+W+"' class='email'>"+W+"</a><br><span><span class='bnov'>BNOV</span> el. paštas</span></p><p class='info-highlight'><i class='fa fa-exclamation' style='color: #C1272D;'></i>Informacija apie <a href='http://www.vilnius.lt/index.php?4265980094' class='email' target='_blank'>bendrijų steigimą</a></p>";G.byId("build-inner-mng").innerHTML=Ma;var Na="<h3>"+w+"<br></h3><p>"+$+"<br><span>Namo energetinis efektyvumas</span></p><p>"+aa+"<br><span>Renovacijos metai</span></p><p>"+da+"<br><span>Kas renovuota</span></p>";G.byId("build-inner-t-msg").innerHTML=Na;var Oa="<h3>"+w+"</h3><p>"+Aa+"<br><span>Namo techninis prižiūrėtojas</span></p><p>"+Ba+"<br><span>Namo šildymo sistemos techinis prižiūrėtojas</span></p><p>"+Ca+"<br><span>Lifto techninis prižiūrėtojas</span></p><p>"+("number"==typeof va?va+" Eur/m²":va)+"<br><span>Administracinis tarifas</span></p><p>"+kaupTar+"<br><span>Kaupiamosios įmokos tarifas</span></p><p>"+ua+"<br><span>Sukauptos lėšos</span></p>";G.byId("build-inner-m-msg").innerHTML=Oa;var Pa="<h3>"+w+"</h3><h4>Dviejų pastatų palyginimas:</h4><div id='compare-btn-block'><span id='start-compare' class='compare'><p>Norėdami  palyginti du skirtingu pastatus, spūstelkite žemiau esantį mygtuką ir palyginimui žemėlapyje pažymėkite naują pastatą .</p><div id='compare-btn' class='bt animate'><a class='button'><i class='fa fa-angle-left' aria-hidden='true'></i>Pasirinkite kitą pastatą palyginimui</a></div><h4 class='border-top'>Sužinokite skirtingų administratorių tarifų vidurkius:</h4><div id='selection-list'></div></span><div id='build-inner-stat-table'></div></div><div id='bar-legend'></div><canvas id='myBarChart' width='433' height='833'></canvas><div id='bar-tips'></div>";G.byId("build-inner-stat").innerHTML=Pa;var Qa,Ra=!1,Sa=G.byId("compare-btn");Sa.addEventListener("click",j,!1);var Ta={ilgalaikisPlanas:"http://zemelapiai.vplanas.lt/Statiniai/Adm_Stat/"+(parseInt(t,10)+1)+"/IP_"+ya+".pdf",ukinisPlanas:"http://zemelapiai.vplanas.lt/Statiniai/Adm_Stat/"+(parseInt(t,10)+1)+"/P_"+ya+".pdf",metineVeiklosAtaskaita:"http://zemelapiai.vplanas.lt/Statiniai/Adm_Stat/"+(parseInt(t,10)+1)+"/AT_"+ya+".pdf"},Ua=0,Va=0,Wa={messagePlanas:"",messageUPlanas:"",messageAtaskaita:""};for(var Xa in Ta)Ta.hasOwnProperty(Xa)&&k(Ta[Xa],Xa);var Ya="<h3>"+w+"<br></h3>";G.byId("build-inner-d").innerHTML=Ya;var Za="<h3>"+w+"<br></h3><p>Turite pasiūlymų ar pastabų? Matote klaidų?</p> <p>Susisiekite el. paštu: <a href='mailto:pastatai@vilnius.lt'>pastatai@vilnius.lt</a></p><p>Norėdami pateikti duomenys apie konkretų pastatą, kviečiame užpildyti <a href='http://zemelapiai.vplanas.lt/Statiniai/Adm_Stat/lentele.xlsx'>duomenų suvedimo lentelę</a> ir persiųsti aukščiau nurodytu el. pašto adresu.</p><p>Informacija apie <a href='http://www.vilnius.lt/index.php?4265980094' target='_blank'>bendrijų steigimą</a></p>";G.byId("build-inner-h").innerHTML=Za;var $a="<h3>"+w+"<br></h3><p><a href='http://www.vilnius.lt/index.php?4265980094' target='_blank'> Bendrijų steigimas </a></p><p><a href='http://www.vilnius.lt/index.php?1568645331' target='_blank'>Jungtinės veiklos sutarties sudarymas</a></p><p><a href='http://www.vilnius.lt/index.php?4278773191' target='_blank'>Administratoriaus keitimas</a></p>";if(G.byId("build-inner-imp-i").innerHTML=$a,o(Ga)||o(Ha)||o(Ia)||o(Ja)){var _a={labels:[t-2+" metai",t-1+" metai",t+" metai"],datasets:[{label:"Atliekų tarifai",fillColor:"rgba(84,59,13,0.2)",strokeColor:"rgba(212,203,188,1)",pointColor:"rgba(212,203,188,1)",pointStrokeColor:"#fff",pointHighlightFill:"#fff",pointHighlightStroke:"rgba(212,203,188,1)",data:Ga},{label:"Lifto techninės priežiūros tarifai Eur/m²",fillColor:"rgba(151, 187, 205, 0.6)",strokeColor:"rgba(151, 187, 205, 1)",pointColor:"rgba(151, 187, 205, 1)",pointStrokeColor:"#fff",pointHighlightFill:"#fff",pointHighlightStroke:"rgba(151,187,205,1)",data:Ha},{label:"Namo techninės priežiūros tarifai Eur/m²",fillColor:"rgba(154, 195, 146, 0.6)",strokeColor:"rgba(154, 195, 146, 1)",pointColor:"rgba(154, 195, 146, 1)",pointStrokeColor:"#fff",pointHighlightFill:"#fff",pointHighlightStroke:"rgba(220, 220, 220, 1)",data:Ia},{label:"Namo šildymo sistemų priežiūros tarifai Eur/m²",fillColor:"rgba(222, 135, 71, 0.6)",strokeColor:"rgba(222, 135, 71, 1)",pointColor:"rgba(222, 135, 71, 1)",pointStrokeColor:"#fff",pointHighlightFill:"#fff",pointHighlightStroke:"rgba(222, 135, 71, 1)",data:Ja}]},ab={scaleShowGridLines:!0,scaleShowLabels:!0,scaleGridLineColor:"rgba(0,0,0,.05)",scaleGridLineWidth:1,scaleShowHorizontalLines:!0,scaleShowVerticalLines:!0,bezierCurve:!0,bezierCurveTension:.4,pointDot:!0,pointDotRadius:6,pointDotStrokeWidth:1,pointHitDetectionRadius:20,datasetStroke:!0,datasetStrokeWidth:2,datasetFill:!1,tooltipCornerRadius:2,multiTooltipTemplate:"<%= value %> Eur/m² ",legendTemplate:'<div class="<%=name.toLowerCase()%>-legend"><% for (var i=0; i<datasets.length; i += 1){%><p><span style="background-color:<%=datasets[i].fillColor%>"></span><%if(datasets[i].label){%><%=datasets[i].label%><%}%></p><%}%></div>'},bb=document.getElementById("myChart").getContext("2d");window.myLine=new Chart(bb).Line(_a,ab,{responsive:!1});var cb=myLine.generateLegend();G.byId("chart-legend").innerHTML="<p><b>TARIFŲ GRAFIKAS:</b></p>"+cb}else{var db=document.getElementById("chart-legend");db.innerHTML="<p>Nėra duomenų apie priežiūros tarifus</p>"}p(ya);var eb;if(!eb){var fb=document.getElementById("chart-legend-heating");fb.innerHTML="<p>Nėra duomenų apie šilumos tarifus</p>"}setTimeout(function(){var a=dijit.byId("selection-list");a.on("change",function(a){"none"!==a?(_.setQuery(a,x),I.add("bar-legend","show"),I.remove("bar-legend","hide"),I.add("bar-tips","show"),I.remove("bar-tips","hide")):(myBar.destroy(),I.add("bar-legend","hide"),I.remove("bar-legend","show"),I.add("bar-tips","hide"),I.remove("bar-tips","show"))})},1e3)}var _={bendrijosColor:"rgba(115, 178, 255, 1)",jvsColor:"rgba(115, 255, 223, 1)",admColor:"rgba(168, 226, 251, 1)",createSelection:function(){return require(["dijit/form/Select"],function(a){var b=new a({name:"selectGraph",options:[{label:"Pasirinkite palyginamajį vidutinį tarifą:",value:"none",selected:!0},{label:"Administracinis tarifas (Eur/m²)",value:"adm"},{label:"Techninės priežiūros tarifas (Eur/m²)",value:"tech"},{label:"Šildymo sistemų priežiūros tarifas (Eur/m²)",value:"sist"},{label:"Atliekų tarifas (Eur/m²)",value:"atl"}]},"selection-list");b.startup()})},setQuery:function(a,b){var c=new v,d=new A,e=new B("http://zemelapiai.vplanas.lt/arcgis/rest/services/TESTAVIMAI/Pastatu_administravimas_test/MapServer/4"),f=this;return d.where="1=1",d.returnGeometry=!1,d.outFields=["*"],e.execute(d).then(function(d){var e=f.showGraphData(d,a,b);c.resolve(e)}),c.promise},showGraphData:function(a,b,c){var d,e=[],f=[],g=[],h=[],i=[],j=[],k=[],l=[],m=[],n=0;for(n;n<a.features.length;n+=1)switch(d=a.features[n].attributes,e.push(d.VALDF_GR),f.push(d.VALDF_GR_T),g.push(d.Namo_administracinis),h.push(d.Atliekos),i.push(d.Tech_priez),j.push(d.Sild_sist_priez),k.push(d.Sildymas),d.VALDF_GR){case 2:l.push(this.bendrijosColor),m.push("rgba(0, 112, 255, 1)");break;case 3:l.push(this.jvsColor),m.push("rgba(0, 168, 132, 1)");break;default:l.push(this.admColor),m.push("rgba(136, 187, 216, 1)")}var o={labels:e,labelsStr:f,admT:g,atliek:h,techP:i,sildP:j,sildVid:k,bgColour:l};this.showGraphics(o,b);for(var p=0;p<myBar.datasets[0].fillColor.length;p+=1){myBar.datasets[0].bars[p].fillColor=l[p];myBar.datasets[0].bars[p].label;c===myBar.datasets[0].bars[p].label?myBar.datasets[0].bars[p].strokeColor="red":myBar.datasets[0].bars[p].strokeColor=m[p],myBar.datasets[0].bars[p].strokeWidth=1}myBar.update()},showGraphics:function(a,b){"undefined"!=typeof myBar&&myBar.destroy();var c;switch(b){case"adm":c=a.admT;break;case"tech":c=a.techP;break;case"sist":c=a.sildP;break;case"sild":c=a.sildVid;break;case"atl":c=a.atliek}var d={labels:a.labelsStr,datasets:[{fillColor:a.bgColour,borderColor:a.bgColour,borderWidth:1,highlightFill:"#F7F7F7",highlightStroke:"rgba(159, 159, 159, 0.91)",data:c,yAxisID:"y-axis-0"}]},e={scaleLineColor:"rgba(0,0,0,.4)",showScale:!0,scaleFontSize:12,scaleFontColor:"#555",scaleShowLabels:!0,scaleLabel:"<%=value%>",tooltipCornerRadius:2,tooltipTemplate:"<%= label%>: <%= value + ' Eur/m²'%>",scaleSteps:1,barValueSpacing:1,responsive:!1},f=document.getElementById("myBarChart").getContext("2d");window.myBar=new Chart(f).Bar(d,e);for(var g,h=myBar.datasets[0].fillColor.getUnique(),i=0;i<h.length;i+=1)h[i]===this.admColor&&(g="<p><span style='background-color:"+h[i]+" '></span>Administratoriai</p>"),h[i]===this.bendrijosColor&&(g+="<p><span style='background-color:"+h[i]+" '></span>Bendrijos</p>"),h[i]===this.jvsColor&&(g+="<p><span style='background-color:"+h[i]+" '></span>JVS</p>");G.byId("bar-legend").innerHTML="<div id='chart-legend'><div class='line-legend'>"+g+"</div></div>",G.byId("bar-tips").innerHTML="<div id='chart-legend'><div class='line-legend'><h5><i class='fa fa-exclamation' style='color: #C1272D; height: auto'></i>Dėl bendrijų ir JVS vidutinių tarifų:</h5><p>Bendrijų ir JVS duomenys nėra tikslūs, nes informacija apie tarifus pateikta mažiau kaip 50 proc. bendrijų arba  jungtinės veiklos sutartimi  valdomų namų.</br>Sprendimas  dėl įmokų tarifų dydžio priimamas Civilinio kodekso 4.85 straipsnyje nustatyta tvarka</p><p><i class='fa fa-exclamation' style='color: #C1272D; height: auto'></i>Duomenys atliekų tarifo grafike pateikiami neįvertinus atliekų tvarkymo paskirstymo skaičiavimo būdo. Bendrijų ir JVS valdomų daugiabučių namų butų ir kitų patalpų savininkams mokestis už atliekų tvarkymą skaičiuojamas ne tik nuo buto naudingo  ploto, bet ir nuo gyventojų skaičiaus bute. Sprendimas priimamas Civilinio kodekso 4.85 straipsnyje nustatyta tvarka.</p></div></div>"}},aa=new B("http://zemelapiai.vplanas.lt/arcgis/rest/services/TESTAVIMAI/Pastatu_administravimas_test/MapServer/1");buildingAdministration=new A,buildingAdministration.outSpatialReference={wkid:3346},buildingAdministration.returnGeometry=!1,buildingAdministration.outFields=["*"];var ba,ca=new A;setTimeout(function(){ba=new B("http://zemelapiai.vplanas.lt/arcgis/rest/services/TESTAVIMAI/Pastatu_administravimas_test/MapServer/2")},150);var da=new J(J.STYLE_SOLID,new O(O.STYLE_SOLID,new E([193,39,45,1]),3),new E([129,183,206,0]));b.setSelectionSymbol(da);var ea=new J(J.STYLE_SOLID,new O(O.STYLE_SOLID,new E([78,78,78,0]),1),new E([195,219,159,0]));b.setRenderer(new D(ea)),a.addLayer(b),i(b,"click",Z);var fa;b.on("mouse-over",function(a){require(["dijit/TooltipDialog","dijit/popup","dojo/on","dojo/dom","dojo/domReady!"],function(a,c,d,e){fa=new a({id:"myTooltipDialog",style:"width: 160px;",content:"<p>Pažymėkite pastatą</p>",onMouseLeave:function(){c.close(fa)}}),fa.startup(),b.on("mouse-move",function(a){c.open({popup:fa,x:a.x+10,y:a.y+10})})})}),b.on("mouse-out",function(){fa.destroy()})})};